<!DOCTYPE html>
<html>
    <head>
        <title>Asterisk Project : Asterisk 12 CEL Specification</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Asterisk Project</a></span>
                            </li>
                                                    <li>
                                <span><a href="Asterisk-12-Documentation_25919697.html">Asterisk 12 Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="Asterisk-12-Specifications_25919699.html">Asterisk 12 Specifications</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Asterisk Project : Asterisk 12 CEL Specification
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                                                Added by  kmoore , edited by  mjordan  on Dec 19, 2013
                    </div>
                    <div id="main-content" class="wiki-content group">
                    <div class="message-content"><p> </p><p><span><style type='text/css'>/*<![CDATA[*/
div.rbtoc1387570489231 {padding: 0px;}
div.rbtoc1387570489231 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1387570489231 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1387570489231'>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-Introduction'>Introduction</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-Scope'>Scope</a></li>
<li><a href='#Asterisk12CELSpecification-Terminology'>Terminology</a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-CELOverview'>CEL Overview</a></li>
<li><a href='#Asterisk12CELSpecification-RecordTypes'>Record Types</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-Stand-AloneRecords'>Stand-Alone Records</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-ChannelStart'><span><span>Channel Start</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-ChannelEnd'><span><span>Channel End</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-Answer'><span><span>Answer</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-Hangup'><span><span>Hangup</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-ApplicationStart'><span><span>Application Start</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-ApplicationEnd'><span><span>Application End</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-UserDefined'><span><span>User Defined</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-LinkedIDEnd'><span><span>Linked ID End</span></span></a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-InteractionRecords'>Interaction Records</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-BridgeEnter'><span><span><span>Bridge</span><span><span><span> Enter</span></span></span><br /></span></span></a></li>
<li><a href='#Asterisk12CELSpecification-BridgeExit'><span><span>Bridge Exit</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-Forward'><span><span>Forward</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-ParkStart'><span><span>Park Start</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-ParkEnd'><span><span>Park End</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-Pickup'><span><span>Pickup</span></span></a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-Meta-Records'>Meta-Records</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-BlindTransfer'><span><span>Blind Transfer</span></span></a></li>
<li><a href='#Asterisk12CELSpecification-AttendedTransfer'><span><span>Attended Transfer</span></span></a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-Bridge-BridgeAttendedTransfers'><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Bridge-Bridge Attended Transfers</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></a></li>
<li><a href='#Asterisk12CELSpecification-Bridge-AppAttendedTransfers'><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Bridge-App Attended Transfers</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></a></li>
<li><a href='#Asterisk12CELSpecification-App-AppAttendedTransfers'><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>App-App Attended Transfers</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-LocalChannelOptimization'><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Local Channel Optimization</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-RemovedRecords'><span><span>Removed Records</span></span></a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-RecordFields'><span><span>Record Fields<br /></span></span></a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-PrimaryFields'>Primary Fields</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-CallerIDName'>CallerID Name</a></li>
<li><a href='#Asterisk12CELSpecification-CallerIDNumber'>CallerID Number</a></li>
<li><a href='#Asterisk12CELSpecification-CallerIDANI'>CallerID ANI</a></li>
<li><a href='#Asterisk12CELSpecification-CallerIDRDNIS'>CallerID RDNIS</a></li>
<li><a href='#Asterisk12CELSpecification-CallerIDDNID'>CallerID DNID</a></li>
<li><a href='#Asterisk12CELSpecification-Extension'>Extension</a></li>
<li><a href='#Asterisk12CELSpecification-Context'>Context</a></li>
<li><a href='#Asterisk12CELSpecification-ChannelName'>Channel Name</a></li>
<li><a href='#Asterisk12CELSpecification-ApplicationName'>Application Name</a></li>
<li><a href='#Asterisk12CELSpecification-ApplicationData'>Application Data</a></li>
<li><a href='#Asterisk12CELSpecification-AccountCode'>Account Code</a></li>
<li><a href='#Asterisk12CELSpecification-PeerAccountCode'>Peer Account Code</a></li>
<li><a href='#Asterisk12CELSpecification-UniqueID'>Unique ID</a></li>
<li><a href='#Asterisk12CELSpecification-LinkedID'>Linked ID</a></li>
<li><a href='#Asterisk12CELSpecification-AMAFlags'>AMA Flags</a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-RecordTypeSpecificFields'>Record Type Specific Fields</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-UserDefinedName'>User Defined Name</a></li>
<li><a href='#Asterisk12CELSpecification-Extra'>Extra</a></li>
</ul>
</li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-LoggingBackends'>Logging Backends</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-Custom'>Custom</a></li>
<li><a href='#Asterisk12CELSpecification-Manager'>Manager</a></li>
<li><a href='#Asterisk12CELSpecification-ODBC'>ODBC</a></li>
<li><a href='#Asterisk12CELSpecification-PGSQL'>PGSQL</a></li>
<li><a href='#Asterisk12CELSpecification-RADIUS'>RADIUS</a></li>
<li><a href='#Asterisk12CELSpecification-SQLite'>SQLite</a></li>
<li><a href='#Asterisk12CELSpecification-TDS'>TDS</a></li>
</ul>
</li>
<li><a href='#Asterisk12CELSpecification-ExampleScenarios'>Example Scenarios</a>
<ul class='toc-indentation'>
<li><a href='#Asterisk12CELSpecification-Two-ParticipantBridge'>Two-Participant Bridge</a></li>
<li><a href='#Asterisk12CELSpecification-Multi-participantConference'>Multi-participant Conference</a></li>
<li><a href='#Asterisk12CELSpecification-DialNominal'>Dial Nominal</a></li>
<li><a href='#Asterisk12CELSpecification-DialBusy'>Dial Busy</a></li>
<li><a href='#Asterisk12CELSpecification-BlindTransfer.1'>Blind Transfer</a></li>
<li><a href='#Asterisk12CELSpecification-AttendedTransfer.1'><span><span><span><span><span><span><span>Attended Transfer</span></span></span></span></span></span></span></a></li>
</ul>
</li>
</ul>
</div></span></p><h1 id="Asterisk12CELSpecification-Introduction"><span>Introduction<br /></span></h1><p><span>Channel Event Logging (CEL) provides a series of records describing the state of channels in Asterisk to any of several event recording backends. <span>CEL records provide substantially more information than CDRs and thus allow an Asterisk User to construct their own more complex billing system.</span></span></p><p><span>As a result of the bridging work done for Asterisk 12, CEL behavior has changed for several events that occur in the system. The most significant changes are:</span></p><ul><li><p><span>AST_CEL_BRIDGE_ENTER and AST_CEL_BRIDGE_EXIT have been introduced to denote participant changes in bridges.</span><span> </span></p></li><li><p><span>AST_CEL_BRIDGE_START and AST_CEL_BRIDGE_END<span> have been removed as they no longer applies to the new bridging framework.</span><br /></span></p></li><li><p><span>AST_CEL_BRIDGE_UPDATE has been removed as it no longer applies to the new bridging framework.</span></p></li><li><p><span>AST_CEL_LOCAL_OPTIMIZE has been added to describe local channel optimizations that occur.<br /></span></p></li><li><p><span>All linkedid accounting and record generation is now handled within the CEL engine.</span></p></li><li><span>The peer field is only used in BRIDGE_ENTER and BRIDGE_EXIT records.<br /></span></li></ul><h2 id="Asterisk12CELSpecification-Scope"><span>Scope</span></h2><p><span><span>This CEL specification applies to Asterisk 12. While some portions of this specification are applicable to prior versions of Asterisk, other portions are specific to Asterisk 12 and their counterparts in prior versions are not discussed.</span></span></p><h2 id="Asterisk12CELSpecification-Terminology"><span>Terminology</span></h2><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>Term</p></th><th class="confluenceTh"><p>Definition</p></th></tr><tr><td class="confluenceTd"><p>CEL</p></td><td class="confluenceTd"><p>Channel Event Logging. The focus of this documentation.</p></td></tr><tr><td class="confluenceTd"><p>CEL record</p></td><td class="confluenceTd"><p>An individual event record produced by the CEL engine.</p></td></tr><tr><td class="confluenceTd"><p>CDR</p></td><td class="confluenceTd"><p>Call Detail Record. An alternative method of extracting billing information from Asterisk. Simpler, but less flexible.</p></td></tr><tr><td class="confluenceTd"><p>Stasis</p></td><td class="confluenceTd"><p>The internal message bus in Asterisk that conveys state to the CEL engine.</p></td></tr><tr><td colspan="1" class="confluenceTd"><p>Primary</p></td><td colspan="1" class="confluenceTd"><p>The channel around which a CEL record is focused.</p></td></tr><tr><td colspan="1" class="confluenceTd"><p>AMI</p></td><td colspan="1" class="confluenceTd"><p>Asterisk Manager Interface</p></td></tr><tr><td colspan="1" class="confluenceTd"><p>CSV</p></td><td colspan="1" class="confluenceTd"><p>Comma Separated Values.  A format commonly used for tabular data when stored outside of a database.</p></td></tr></tbody></table></div><h1 id="Asterisk12CELSpecification-CELOverview"><span>CEL Overview</span></h1><p><span><span>A CEL record contains information about a system event including a partial dump of the Primary's state and may contain data relevant to that specific record type such as channel names, bridge unique identifiers, channel variable values, or other miscellaneous information. The CEL engine tracks changes in individual channel state and guarantees ordering of records for a given Primary, but does not guarantee ordering of records in relation to other Primaries. The exception to this record ordering occurs with meta-records which occur adjacent to the events they describe. Applicable event ordering is provided in the descriptions below. CEL output does not describe interaction with MeetMe conferences other than MeetMe as an application.<br /></span></span></p><h1 id="Asterisk12CELSpecification-RecordTypes">Record Types</h1><p><span><span>The records produced by the CEL engine can be grouped in to three general categories:</span></span></p><h2 id="Asterisk12CELSpecification-Stand-AloneRecords"><span>Stand-Alone Records</span></h2><p><span><span><span>These records convey a channel event on the channel that does not involve channels or bridges other than the Primary.</span></span></span></p><h3 id="Asterisk12CELSpecification-ChannelStart"><span><span><span>Channel Start</span></span></span></h3><p><span><span><span>An AST_CEL_CHANNEL_START record is generated when a channel is created. This record introduces a new Primary and is the first record available for all Primaries.<br /></span></span></span></p><h3 id="Asterisk12CELSpecification-ChannelEnd"><span><span><span>Channel End</span></span></span></h3><p><span><span><span><span><span><span>An AST_CEL_CHAN_END record is generated when a channel is destroyed. This record indicates that a Primary is going away and that there will be no further records for this Primary with the exception of AST_CEL_LINKEDID_END.<br /></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-Answer"><span><span><span>Answer</span></span></span></h3><p><span><span><span><span><span><span>An AST_CEL_ANSWER record is generated when a channel is answered. Depending on the state transitions that occur on a Primary, this record may not be generated.<br /></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-Hangup"><span><span><span>Hangup</span></span></span></h3><p><span><span><span><span><span><span><span><span><span>An AST_CEL_HANGUP record is generated when a channel is hung up. This record will occur on every Primary prior to channel destruction.<br /></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-ApplicationStart"><span><span><span>Application Start</span></span></span></h3><p><span><span><span><span><span><span><span><span><span>An AST_CEL_APP_START record is generated when a channel enters an application. This record will always be generated before its corresponding AST_CEL_APP_END.<br /></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-ApplicationEnd"><span><span><span>Application End</span></span></span></h3><p><span><span><span><span><span><span><span><span><span><span><span><span>An AST_CEL_APP_END record is generated when a channel exits an application. This record will be generated after its corresponding AST_CEL_APP_START, but is not guaranteed to be generated on hangup.<br /></span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-UserDefined"><span><span><span>User Defined</span></span></span></h3><p><span><span><span><span><span><span><span><span><span><span><span><span>An AST_CEL_USER_DEFINED record is generated when a channel enters the CELGenUserEvent application. The application sets the user defined name field and additional information in the extra field in the &quot;extra&quot; key.<br /></span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-LinkedIDEnd"><span><span><span>Linked ID End</span></span></span></h3><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>An AST_CEL_LINKEDID_END record is generated when the last channel using the given linked ID is destroyed or the last instance of a linked ID is overwritten by a different linked ID. This is the only type of record that may occur after AST_CEL_CHANNEL_END.<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="Asterisk12CELSpecification-InteractionRecords"><span>Interaction Records</span></h2><p><span><span><span>These records convey the Primary's interactions with other channels or bridges.</span></span></span></p><h3 id="Asterisk12CELSpecification-BridgeEnter" class="message-content"><span><span><span><span>Bridge</span><span><span><span> Enter</span></span></span><br /></span></span></span></h3><p><span><span><span>An AST_CEL_BRIDGE_ENTER record is generated when a channel enters a bridge. The entering channel is the Primary for this event. <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Additional information is conveyed in the extra field under the &quot;bridge_id&quot; key.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> All other channels in the bridge at the time of entry are available in the peer field as a comma-separated list.<br /></span></span></span></p><h3 id="Asterisk12CELSpecification-BridgeExit"><span><span><span>Bridge Exit</span></span></span></h3><p><span><span><span><span><span><span>An AST_CEL_BRIDGE_EXIT record is generated when a channel exits a bridge. The leaving channel is the Primary for this event.<span><span><span> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Additional information is conveyed in the extra field under the &quot;bridge_id&quot; key.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span><span><span><span> All other channels in the bridge at the time of exit are available in the peer field as a comma-separated list.</span></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-Forward"><span><span><span>Forward</span></span></span></h3><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>An AST_CEL_FORWARD record is generated when a dialing channel is forwarded elsewhere by a dialed channel. The dialing channel is the Primary for this event.<span><span><span><span><span><span> Additional information is conveyed in the extra field under the &quot;forward&quot; key.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-ParkStart"><span><span><span>Park Start</span></span></span></h3><p><span><span><span><span><span><span>An AST_CEL_PARK_START record is generated when a channel is parked. The parked channel is the Primary for this event. Additional information is conveyed in the extra field under the keys &quot;parker_dial_string&quot; and &quot;parking_lot&quot;.<br /></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-ParkEnd"><span><span><span>Park End</span></span></span></h3><p><span><span><span><span><span><span><span><span><span>An AST_CEL_PARK_START record is generated when a channel is unparked. The unparked channel is the Primary for this event. <span><span><span><span><span><span> Additional information is conveyed in the extra field under the &quot;reason&quot; key. This record always occurs after its corresponding AST_CEL_PARK_START.<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-Pickup"><span><span><span>Pickup</span></span></span></h3><p><span><span><span><span><span><span><span><span><span><span><span><span>An AST_CEL_PICKUP record is generated when a channel is picked up. The picked up channel (also known as the target) is the Primary for this record. <span><span><span><span><span><span> The name of the channel that is picking up is <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>conveyed in the extra field under the &quot;pickup_channel&quot; key.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="Asterisk12CELSpecification-Meta-Records"><span>Meta-Records</span></h2><p><span><span><span>These records convey additional context relating to surrounding CEL records</span></span></span></p><h3 id="Asterisk12CELSpecification-BlindTransfer"><span><span><span>Blind Transfer</span></span></span></h3><p><span><span><span>An AST_CEL_BLINDTRANSFER record is generated when a blind transfer feature is activated on a bridge. The initiating channel is the Primary for this record.<span><span><span><span><span><span><span><span><span><span><span><span> <span><span><span><span><span><span> Additional information is conveyed in the extra field under the &quot;extension&quot;, &quot;context&quot;, and &quot;bridge_id&quot; keys.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br /></span></span></span></p><h3 id="Asterisk12CELSpecification-AttendedTransfer"><span><span><span>Attended Transfer</span></span></span></h3><p><span><span><span><span><span><span>An AST_CEL_ATTENDEDTRANSFER record is generated when an attended transfer is successfully performed.<span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h4 id="Asterisk12CELSpecification-Bridge-BridgeAttendedTransfers"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Bridge-Bridge Attended Transfers</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></h4><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>This type of attended transfer occurs when both involved channels are bridged. The initiating channel is the Primary for this record. <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Additional information is conveyed in the extra field under the &quot;bridge1_id&quot;, &quot;channel2_name&quot;, and &quot;bridge2_id&quot; keys.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>The records associated with this type of transfer will vary depending on the configuration of the bridges involved and the number of channels involved. Possible methods of accomplishing the transfer include (but are not limited to) channel swap, bridge merge, and bridge link via a local channel.<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h4 id="Asterisk12CELSpecification-Bridge-AppAttendedTransfers"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Bridge-App Attended Transfers</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></h4><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>This type of attended transfer occurs when one involved channel is bridged while the other is running an application. The bridged channel is the Primary for this record. <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Additional information is conveyed in the extra field under the &quot;bridge1_id&quot;, &quot;channel2_name&quot;, and &quot;app&quot; keys.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h4 id="Asterisk12CELSpecification-App-AppAttendedTransfers"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>App-App Attended Transfers</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></h4><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Attended transfers involving only channels that are running applications are not currently possible. This is not possible with internal transfers since there is no bridge involved to handle the feature codes and any externally initiated attended transfer that attempts to bridge two app-bound channels will fail.<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Asterisk12CELSpecification-LocalChannelOptimization"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Local Channel Optimization</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></h3><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>An AST_CEL_LOCAL_OPTIMIZE record is generated when a local channel optimization attempt completes successfully. The semi-one (local channel ending in ';1') channel is the Primary for this event. The name of the semi-two (local channel ending in ';2') channel is conveyed in the extra field under the &quot;local_two&quot; key.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="Asterisk12CELSpecification-RemovedRecords"><span><span><span>Removed Records</span></span></span></h2><p><span><span><span>The following record types are no longer available in Asterisk 12:</span></span></span></p><ul><li><p><span><span><span>AST_CEL_BRIDGE_START</span></span></span></p></li><li><p><span><span><span>AST_CEL_BRIDGE_END</span></span></span></p></li><li><p><span><span><span>AST_CEL_CONF_START</span></span></span></p></li><li><p><span><span><span>AST_CEL_CONF_END</span></span></span></p></li><li><p><span><span><span>AST_CEL_CONF_ENTER</span></span></span></p></li><li><p><span><span><span>AST_CEL_CONF_EXIT</span></span></span><span><span><span><br /></span></span></span></p></li><li><p><span><span><span>AST_CEL_HOOKFLASH</span></span></span></p></li><li><p><span><span><span>AST_CEL_3WAY_START</span></span></span></p></li><li><p><span> </span><span><span><span><span><span><span><span><span><span>AST_CEL_3WAY_END</span></span></span></span></span></span></span></span></span></p></li><li><p><span><span><span><span><span><span>AST_CEL_BRIDGE_UPDATE</span></span></span></span></span></span></p></li><li><p><span><span><span><span><span><span>AST_CEL_TRANSFER</span></span></span></span></span></span></p></li></ul><h1 id="Asterisk12CELSpecification-RecordFields"><span><span><span>Record Fields<br /></span></span></span></h1><h2 id="Asterisk12CELSpecification-PrimaryFields"><span>Primary Fields</span></h2><p><span>These fields are populated exclusively from their corresponding fields on the Primary in a consistent manner for every CEL record.<br /></span></p><h3 id="Asterisk12CELSpecification-CallerIDName"><span>CallerID Name</span></h3><p><span>The name identifying the caller for this channel.<br /></span></p><h3 id="Asterisk12CELSpecification-CallerIDNumber"><span>CallerID Number</span></h3><p><span><span>The number identifying the caller for this channel.</span></span></p><h3 id="Asterisk12CELSpecification-CallerIDANI"><span>CallerID ANI</span></h3><p><span>Automatic Number Identification caller information provided for this channel.<br /></span></p><h3 id="Asterisk12CELSpecification-CallerIDRDNIS"><span>CallerID RDNIS</span></h3><p><span>Redirecting information for this channel.<br /></span></p><h3 id="Asterisk12CELSpecification-CallerIDDNID"><span>CallerID DNID</span><span> </span></h3><p><span>Dialed Number Identification for this channel.<br /></span></p><h3 id="Asterisk12CELSpecification-Extension"><span>Extension</span></h3><p>The extension in which this channel is currently executing.</p><h3 id="Asterisk12CELSpecification-Context"><span>Context</span><span> </span></h3><p><span>The context in which this channel is currently executing.<br /></span></p><h3 id="Asterisk12CELSpecification-ChannelName"><span>Channel Name</span><span> </span></h3><p><span>The name of this channel.<br /></span></p><h3 id="Asterisk12CELSpecification-ApplicationName"><span>Application Name</span></h3><p><span>The name of the application that this channel is currently executing.<br /></span></p><h3 id="Asterisk12CELSpecification-ApplicationData"><span>Application Data</span></h3><p><span>The data provided to the application being executed.<br /></span></p><h3 id="Asterisk12CELSpecification-AccountCode"><span>Account Code</span></h3><p><span>The account code used for billing.<br /></span></p><h3 id="Asterisk12CELSpecification-PeerAccountCode"><span>Peer Account Code</span></h3><p><span>The peer channel's account code.<br /></span></p><h3 id="Asterisk12CELSpecification-UniqueID"><span>Unique ID</span></h3><p><span>This channel's instance unique identifier.<br /></span></p><h3 id="Asterisk12CELSpecification-LinkedID"><span>Linked ID</span></h3><p><span>This channel's current linked ID which is affected by bridging operations. This identifier starts as the channel's unique ID.<br /></span></p><h3 id="Asterisk12CELSpecification-AMAFlags"><span>AMA Flags</span></h3><p><span>This channel's Automated Message Accounting flags.<br /></span></p><h2 id="Asterisk12CELSpecification-RecordTypeSpecificFields"><span>Record Type Specific Fields</span></h2><p><span>These fields vary or may be blank depending on the CEL record type.<br /></span></p><h3 id="Asterisk12CELSpecification-UserDefinedName"><span>User Defined Name</span></h3><p><span>This field is only used for AST_CEL_USER_DEFINED and conveys the user-specified event type.<br /></span></p><h3 id="Asterisk12CELSpecification-Extra"><span>Extra</span></h3><p><span>This field contains a JSON blob describing additional record-type-specific information.<br /></span></p><h1 id="Asterisk12CELSpecification-LoggingBackends"><span>Logging Backends</span></h1><p><span>CEL provides several methods of logging records to be processed at a later time. CEL only publishes record types to backends that are enabled in the general CEL configuration. Sample configurations are provided with the Asterisk 12 source for all of these backends.</span></p><h2 id="Asterisk12CELSpecification-Custom"><span>Custom<br /></span></h2><p><span><span>The Custom CEL output module provides logging capabilit</span>y to a CSV file in a format described in the configuration file<span>. This module is configured in cel_custom.conf.</span></span></p><h2 id="Asterisk12CELSpecification-Manager"><span>Manager</span></h2><p><span>The manager CEL output module publishes records over AMI as CEL events with the record type published under the &quot;EventName&quot; key. This module is configured in cel.conf in the [manager] section.</span></p><h2 id="Asterisk12CELSpecification-ODBC"><span>ODBC</span></h2><p><span>The ODBC CEL output module provides logging capability to any ODBC-compatible database. This module is configured in cel_odbc.conf.<br /></span></p><h2 id="Asterisk12CELSpecification-PGSQL"><span>PGSQL</span></h2><p><span>The PGSQL CEL output module provides logging capability to PostgreSQL databases when it is desirable to avoid the ODBC abstraction layer.<span> This module is configured in cel_pgsql.conf.</span></span></p><h2 id="Asterisk12CELSpecification-RADIUS"><span>RADIUS</span></h2><p><span><span><span>The RADIUS CEL output module allows the CEL engine to publish records to a RADIUS server.<span> This module is configured in cel.conf in the [radius] section.</span></span></span><br /></span></p><h2 id="Asterisk12CELSpecification-SQLite"><span>SQLite</span></h2><p><span>The SQLite CEL output module provides logging capability to a SQLite3 database in a format described in its configuration file.<span><span> This module is configured in cel_sqlite3_custom.conf.</span></span><br /></span></p><h2 id="Asterisk12CELSpecification-TDS"><span>TDS</span></h2><p><span>The TDS CEL output module provides logging capability to Sybase or Microsoft SQL Server databases when it is desirable to avoid the ODBC abstraction layer. This module is configured in cel_tds.conf.</span></p><h1 id="Asterisk12CELSpecification-ExampleScenarios"><span>Example Scenarios</span></h1><p><span>For the following scenarios, assume the CEL engine is configured to generate the following record types:</span></p><ul><li><p><span>AST_CEL_CHANNEL_START</span></p></li><li><p><span>AST_CEL_CHAN_END</span></p></li><li><p><span>AST_CEL_BRIDGE_ENTER</span></p></li><li><p><span>AST_CEL_BRIDGE_EXIT</span></p></li></ul><h2 id="Asterisk12CELSpecification-Two-ParticipantBridge"><span>Two-Participant Bridge<br /></span></h2><p class="message-content"><span>The following scenario</span><span> demonstrates channel creation, channel destruction, bridge start, and bridge end:</span></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Event</th><th class="confluenceTh">Record</th><th colspan="1" class="confluenceTh">Primary</th><th colspan="1" class="confluenceTh">Extra</th></tr><tr><td class="confluenceTd"><span><span>Channel</span> Alice is created</span></td><td class="confluenceTd"><span>AST_CEL_CHANNEL_START</span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Channel Bob is created</span></span></td><td class="confluenceTd"><span><span>AST_CEL_CHANNEL_START</span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Bridge Link is created</span></span></td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Alice enters bridge Link</span></span></td><td class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td class="confluenceTd"><span><span><span><span>Bob enters bridge Link</span></span></span></span></td><td class="confluenceTd"><span><span><span><span>AST_CEL_BRIDGE_ENTER</span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd"><span><span><span><span>Bob exits bridge Link</span></span></span></span></td><td colspan="1" class="confluenceTd"><span><span><span><span>AST_CEL_BRIDGE_EXIT</span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Bob is destroyed</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><span><span><span><span><span>Alice exits bridge Link</span></span></span></span></span></td><td colspan="1" class="confluenceTd"><span><span><span><span>AST_CEL_BRIDGE_EXIT</span></span></span></span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Alice is destroyed</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr></tbody></table></div><h2 id="Asterisk12CELSpecification-Multi-participantConference"><span>Multi-participant Conference</span></h2><p> </p><p><span><span>The following scenario</span><span> demonstrates conversion of a bridge to a multi-participant conference:</span></span></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" class="confluenceTh"><p>Event</p></th><th colspan="1" class="confluenceTh"><p>Record</p></th><th colspan="1" class="confluenceTh"><p>Primary</p></th><th colspan="1" class="confluenceTh"><p>Extra</p></th></tr><tr><td class="confluenceTd"><p><span><span>Channel</span> Alice is created</span></p></td><td class="confluenceTd"><p><span>AST_CEL_CHANNEL_START</span></p></td><td colspan="1" class="confluenceTd"><p>Alice</p></td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><p><span><span>Channel Bob is created</span></span></p></td><td class="confluenceTd"><p><span><span>AST_CEL_CHANNEL_START</span></span></p></td><td class="confluenceTd"><p>Bob</p></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><p><span><span>Channel Charlie is created</span></span></p></td><td class="confluenceTd"><p><span><span>AST_CEL_CHANNEL_START</span></span></p></td><td class="confluenceTd"><p>Charlie</p></td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><p><span><span>Channel David is created</span></span></p></td><td class="confluenceTd"><p><span><span>AST_CEL_CHANNEL_START</span></span></p></td><td colspan="1" class="confluenceTd"><p>David</p></td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><p><span><span>Bridge Link is created</span></span></p></td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><p><span><span>Alice enters bridge Link</span></span></p></td><td class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span>AST_CEL_CONF_ENTER</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Alice</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td class="confluenceTd"><p><span><span><span><span>Bob enters bridge Link</span></span></span></span></p></td><td class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>AST_CEL_CONF_ENTER</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td><td class="confluenceTd"><p>Bob</p></td><td class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td class="confluenceTd"><p><span><span><span><span>Charlie enters bridge Link</span></span></span></span></p></td><td class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>AST_CEL_CONF_ENTER</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td><td class="confluenceTd"><p>Charlie</p></td><td class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td class="confluenceTd"><p><span><span><span><span>David enters bridge Link</span></span></span></span></p></td><td class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>AST_CEL_CONF_ENTER</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>David</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><p><span><span><span><span>Alice exits bridge Link</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span>AST_CEL_CONF_EXIT</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Alice</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><p>Alice is destroyed</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Alice</p></td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><p><span><span><span><span>Bob exits bridge Link</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span>AST_CEL_CONF_EXIT</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Bob</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><p>Bob is destroyed</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Bob</p></td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><p><span><span><span><span>Charlie exits bridge Link</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span>AST_CEL_CONF_EXIT</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Charlie</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><p>Charlie is destroyed</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>Charlie</p></td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><p><span><span><span><span>David exits bridge Link</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span>AST_CEL_CONF_EXIT</span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>David</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>{&quot;bridge_id&quot;, &quot;Link&quot;}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><p>David is destroyed</p></td><td colspan="1" class="confluenceTd"><p><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></p></td><td colspan="1" class="confluenceTd"><p>David</p></td><td colspan="1" class="confluenceTd"> </td></tr></tbody></table></div><br /><h2 id="Asterisk12CELSpecification-DialNominal"><span>Dial Nominal</span></h2><p><span>For this scenario, assume that AST_CEL_ANSWER, AST_CEL_HANGUP, AST_CEL_APP_START, and AST_CEL_APP_END are configured in addition to the aforementioned record types and that &quot;Dial&quot; is configured to be watched.</span></p><p><span>The following scenario demonstrates a Dial that results in an answer followed by bridging and hangup:</span></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Event</th><th class="confluenceTh">Record</th><th colspan="1" class="confluenceTh">Primary</th><th colspan="1" class="confluenceTh">Extra</th></tr><tr><td class="confluenceTd"><span><span>Channel</span> Alice is created</span></td><td class="confluenceTd"><span>AST_CEL_CHANNEL_START</span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Alice executes Dial(SIP/Bob)</td><td colspan="1" class="confluenceTd">AST_CEL_APP_START</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Channel Bob is created</span></span></td><td class="confluenceTd"><span><span>AST_CEL_CHANNEL_START</span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Bob answers</td><td colspan="1" class="confluenceTd">AST_CEL_ANSWER</td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Alice answers</td><td colspan="1" class="confluenceTd">AST_CEL_ANSWER</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Bridge Link is created</span></span></td><td class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Alice enters bridge Link</span></span></td><td class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td class="confluenceTd"><span><span><span><span>Bob enters bridge Link</span></span></span></span></td><td class="confluenceTd"><span><span><span><span>AST_CEL_BRIDGE_ENTER</span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd"><span><span><span><span>Bob initiates hangup, exits bridge Link</span></span></span></span></td><td colspan="1" class="confluenceTd"><span><span><span><span>AST_CEL_BRIDGE_EXIT</span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Bob completes hang up</td><td colspan="1" class="confluenceTd">AST_CEL_HANGUP</td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;Bob&quot;</span>}</span></span></td></tr><tr><td colspan="1" class="confluenceTd">Bob is destroyed</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"><span><span><span><span><span>Alice exits bridge Link</span></span></span></span></span></td><td colspan="1" class="confluenceTd"><span><span><span><span>AST_CEL_BRIDGE_EXIT</span></span></span></span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;: &quot;Link&quot;}</td></tr><tr><td class="confluenceTd">Alice is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Alice</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;ANSWER&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td colspan="1" class="confluenceTd">Alice is destroyed</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr></tbody></table></div><h2 id="Asterisk12CELSpecification-DialBusy"><span>Dial Busy</span></h2><p><span>For this scenario, assume that AST_CEL_ANSWER, AST_CEL_HANGUP, AST_CEL_APP_START, and AST_CEL_APP_END are configured in addition to the aforementioned record types and that &quot;Dial&quot; is configured to be watched. The following scenario demonstrates a Dial that results in a busy:</span></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Event</th><th class="confluenceTh">Record</th><th colspan="1" class="confluenceTh">Primary</th><th colspan="1" class="confluenceTh">Extra</th></tr><tr><td class="confluenceTd"><span><span>Channel</span> Alice is created</span></td><td class="confluenceTd"><span>AST_CEL_CHANNEL_START</span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Alice executes Dial(SIP/Bob)</td><td colspan="1" class="confluenceTd">AST_CEL_APP_START</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Channel Bob is created</span></span></td><td class="confluenceTd"><span><span>AST_CEL_CHANNEL_START</span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Bob responds BUSY</td><td colspan="1" class="confluenceTd">AST_CEL_HANGUP</td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> <span><span>{<span>&quot;hangupcause&quot;:21,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td colspan="1" class="confluenceTd">Bob is destroyed</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Alice is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Alice</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:17,&quot;dialstatus&quot;:&quot;BUSY&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td colspan="1" class="confluenceTd">Alice is destroyed</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHAN_END</span></span></span></span></span></span></span></span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr></tbody></table></div><p> </p></div><h2 id="Asterisk12CELSpecification-BlindTransfer.1" class="message-content"><span>Blind Transfer</span></h2><p><span>For this scenario, assume that AST_CEL_HANGUP is configured in addition to the aforementioned record types. The following scenario demonstrates a blind transfer:</span><br /><span> </span></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Event</th><th class="confluenceTh">Record</th><th colspan="1" class="confluenceTh">Primary</th><th colspan="1" class="confluenceTh">Extra</th></tr><tr><td class="confluenceTd"><span><span>Channel</span> Alice is created</span></td><td class="confluenceTd"><span>AST_CEL_CHANNEL_START</span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Channel Bob is created</span></span></td><td class="confluenceTd"><span><span>AST_CEL_CHANNEL_START</span></span></td><td class="confluenceTd">Bob</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Alice answers</td><td class="confluenceTd"><span><span>AST_CEL_ANSWER</span></span></td><td class="confluenceTd">Alice</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bob answers</td><td class="confluenceTd"><span><span>AST_CEL_ANSWER</span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Bridge Link is created</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bob enters bridge Link</td><td class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td class="confluenceTd">Bob</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Alice enters bridge Link</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Alice initiates a blind transfer to <span><span><span><span>exten@context</span></span></span></span></td><td colspan="1" class="confluenceTd">AST_CEL_BLINDTRANSFER</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"><span>{&quot;bridge_id&quot;:&quot;Link&quot;,&quot;extension&quot;:&quot;exten&quot;,&quot;context&quot;:&quot;context&quot;}</span></td></tr><tr><td colspan="1" class="confluenceTd">Alice exits bridge Link</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link&quot;}</td></tr><tr><td class="confluenceTd">Alice is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Alice</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td class="confluenceTd">Alice is destroyed</td><td class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHANNEL_END</span></span></span></span></span></span></span></span></td><td class="confluenceTd">Alice</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">A local channel pair is created to handle dialplan</td><td class="confluenceTd">AST_CEL_CHANNEL_START</td><td class="confluenceTd">Local1</td><td class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">AST_CEL_CHANNEL_START</td><td colspan="1" class="confluenceTd">Local2</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Local1 enters bridge Link</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td colspan="1" class="confluenceTd">Local1</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Local2 executes dialplan at exten@context</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Local2 is eventually hung up by the dialplan</td><td colspan="1" class="confluenceTd">AST_CEL_HANGUP</td><td colspan="1" class="confluenceTd">Local2</td><td colspan="1" class="confluenceTd"><span><span><span><span><span><span><span><span><span><span><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr><td colspan="1" class="confluenceTd">Hangup is initiated on Local1, exiting bridge Link</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td colspan="1" class="confluenceTd">Local1</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link&quot;}</td></tr><tr><td class="confluenceTd">Local1 is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Local1</td><td class="confluenceTd"><span><span><span><span><span><span><span><span><span><span><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr><td class="confluenceTd">Local1 is destroyed</td><td class="confluenceTd">AST_CEL_CHANNEL_END</td><td class="confluenceTd">Local1</td><td class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Local2 is destroyed</td><td colspan="1" class="confluenceTd">AST_CEL_CHANNEL_END</td><td colspan="1" class="confluenceTd">Local2</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Bob is the last channel and so is hung up</td><td colspan="1" class="confluenceTd">AST_CEL_HANGUP</td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td class="confluenceTd">Bob is destroyed</td><td class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHANNEL_END</span></span></span></span></span></span></span></span></td><td class="confluenceTd">Bob</td><td class="confluenceTd"> </td></tr></tbody></table></div><h2 id="Asterisk12CELSpecification-AttendedTransfer.1"><span><span><span><span><span><span><span><span>Attended Transfer</span></span></span></span></span></span></span></span></h2><p><span><span><span><span><span><span><span><span><span>For this scenario, assume that AST_CEL_ANSWER and AST_CEL_HANGUP are configured in addition to the aforementioned record types. The following scenario demonstrates a channel-swapping attended transfer:</span></span></span></span></span></span></span></span></span></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Event</th><th class="confluenceTh">Record</th><th colspan="1" class="confluenceTh">Primary</th><th colspan="1" class="confluenceTh">Extra</th></tr><tr><td class="confluenceTd"><span><span>Channel</span> Alice is created</span></td><td class="confluenceTd"><span>AST_CEL_CHANNEL_START</span></td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Channel Bob is created</span></span></td><td class="confluenceTd"><span><span>AST_CEL_CHANNEL_START</span></span></td><td class="confluenceTd">Bob</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Alice answers</td><td class="confluenceTd"><span><span>AST_CEL_ANSWER</span></span></td><td class="confluenceTd">Alice</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bob answers</td><td class="confluenceTd"><span><span>AST_CEL_ANSWER</span></span></td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">Bridge Link1 is created</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bob enters bridge Link1</td><td class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td class="confluenceTd">Bob</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link1&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Alice enters bridge Link1</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td colspan="1" class="confluenceTd">Alice</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link1&quot;}</td></tr><tr><td class="confluenceTd"><span><span>Channel</span> Charlie is created</span></td><td class="confluenceTd"><span>AST_CEL_CHANNEL_START</span></td><td class="confluenceTd">Charlie</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"><span><span>Channel David is created</span></span></td><td class="confluenceTd"><span><span>AST_CEL_CHANNEL_START</span></span></td><td class="confluenceTd">David</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Charlie answers</td><td class="confluenceTd"><span><span>AST_CEL_ANSWER</span></span></td><td class="confluenceTd">Charlie</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">David answers</td><td class="confluenceTd"><span><span>AST_CEL_ANSWER</span></span></td><td class="confluenceTd">David</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bridge Link2 is created</td><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">David enters bridge Link2</td><td class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td class="confluenceTd">Bob</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link2&quot;}</td></tr><tr><td class="confluenceTd">Charlie enters bridge Link2</td><td class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td class="confluenceTd">Alice</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link2&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">An attended transfer between Alice and David begins</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bob exits bridge Link1</td><td class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td class="confluenceTd">Bob</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link1&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Bob enters bridge Link2</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_ENTER</td><td colspan="1" class="confluenceTd">Bob</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link2&quot;}</td></tr><tr><td class="confluenceTd">David exits bridge Link2</td><td class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td class="confluenceTd">David</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link2&quot;}</td></tr><tr><td class="confluenceTd">David is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">David</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td class="confluenceTd">David is destroyed</td><td class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHANNEL_END</span></span></span></span></span></span></span></span></td><td class="confluenceTd">David</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Alice and David execute an attended transfer<span> </span></td><td class="confluenceTd">AST_CEL_ATTENDEDTRANSFER</td><td class="confluenceTd">Alice</td><td class="confluenceTd"><span><span>{&quot;bridge1_id&quot;:&quot;Link1&quot;,&quot;channel2_name&quot;:&quot;David&quot;,&quot;bridge2_id&quot;:&quot;Link2&quot;}</span></span></td></tr><tr><td class="confluenceTd">Alice exits bridge Link1</td><td class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td class="confluenceTd">Alice</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link1&quot;}</td></tr><tr><td class="confluenceTd">Alice is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Alice</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td class="confluenceTd">Alice is destroyed</td><td class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHANNEL_END</span></span></span></span></span></span></span></span></td><td class="confluenceTd">Alice</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Bob exits bridge Link2</td><td class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td class="confluenceTd">Bob</td><td class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link2&quot;}</td></tr><tr><td colspan="1" class="confluenceTd">Charlie exits bridge Link2</td><td colspan="1" class="confluenceTd">AST_CEL_BRIDGE_EXIT</td><td colspan="1" class="confluenceTd">Charlie</td><td colspan="1" class="confluenceTd">{&quot;bridge_id&quot;:&quot;Link2&quot;}</td></tr><tr><td class="confluenceTd">Bob is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Bob</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td class="confluenceTd">Bob is destroyed</td><td class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHANNEL_END</span></span></span></span></span></span></span></span></td><td class="confluenceTd">Bob</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">Charlie is hung up</td><td class="confluenceTd">AST_CEL_HANGUP</td><td class="confluenceTd">Charlie</td><td class="confluenceTd"><span><span>{<span>&quot;hangupcause&quot;:16,&quot;dialstatus&quot;:&quot;&quot;,&quot;hangupsource&quot;:&quot;&quot;</span>}</span></span></td></tr><tr><td class="confluenceTd">Charlie is destroyed</td><td class="confluenceTd"><span><span><span><span><span><span><span><span>AST_CEL_CHANNEL_END</span></span></span></span></span></span></span></span></td><td class="confluenceTd">Charlie</td><td class="confluenceTd"> </td></tr></tbody></table></div><p><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>Note that the ATTENDEDTRANSFER event does not necessarily occur before or after the records it is related to.<br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer">
                <section class="footer-body">
                    <p>Document generated by Confluence on Dec 20, 2013 14:14</p>
                </section>
            </div>
        </div>     </body>
</html>
