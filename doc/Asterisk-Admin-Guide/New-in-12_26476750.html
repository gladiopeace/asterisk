<!DOCTYPE html>
<html>
    <head>
        <title>Asterisk Project : New in 12</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Asterisk Project</a></span>
                            </li>
                                                    <li>
                                <span><a href="Asterisk-12-Documentation_25919697.html">Asterisk 12 Documentation</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Asterisk Project : New in 12
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                                                Added by  mjordan , edited by  mjordan  on Dec 19, 2013
                    </div>
                    <div id="main-content" class="wiki-content group">
                    <h1 id="Newin12-Overview">Overview</h1><p>Asterisk 12 is a standard release of the Asterisk project. As such, the focus of development for this release was on core architectural changes and major new features. This includes:</p><ul><li>A more flexible bridging core based on the Bridging API</li><li>A new internal message bus, Stasis</li><li>Major standardization and consistency improvements to AMI</li><li>Addition of the Asterisk REST Interface (ARI)</li><li>A new SIP channel driver, chan_pjsip</li></ul><p>In addition, as the vast majority of bridging in Asterisk was migrated to the Bridging API used by ConfBridge, major changes were made to most of the interfaces in Asterisk. This includes not only AMI, but also CDRs and CEL.</p><p>Specifications have been written for the affected interfaces:</p><ul><li><a href="AMI-v2-Specification_22086004.html">AMI v2 Specification</a></li><li><a href="Asterisk-12-CEL-Specification_25919712.html">Asterisk 12 CEL Specification</a></li><li><a href="Asterisk-12-CDR-Specification_22088359.html">Asterisk 12 CDR Specification</a></li></ul><p>It is <strong>highly</strong> recommended that anyone migrating to Asterisk 12 read the information regarding its release both in the <a href="http://svn.asterisk.org/svn/asterisk/branches/12/CHANGES" class="external-link" rel="nofollow">CHANGES</a> files and in the accompanying <a href="http://svn.asterisk.org/svn/asterisk/branches/12/UPGRADE.txt" class="external-link" rel="nofollow">UPGRADE.txt</a> file.</p><h1 id="Newin12-BuildSystem"><span style="line-height: 1.25;">Build System</span></h1><ul><li>Added build option <code>DISABLE_INLINE</code>. This option can be used to work around a bug in gcc. For more information, see <a href="http://gcc.gnu.org/bugzilla/show_bug.cgi?id=47816" class="external-link" rel="nofollow">http://gcc.gnu.org/bugzilla/show_bug.cgi?id=47816</a></li><li>Removed the <code>CHANNEL_TRACE</code> development mode build option. Certain aspects of the <code>CHANNEL_TRACE</code> build option were incompatible with the new bridging architecture.</li><li>Asterisk now optionally uses <code>libxslt</code> to improve XML documentation generation and maintainability. If libxslt is not available on the system, some XML documentation will be incomplete.</li><li>Asterisk now depends on <code>libjansson</code>. If a package of <code>libjansson</code> is not available on your distro, please see <a href="http://www.digip.org/jansson/" class="external-link" rel="nofollow">http://www.digip.org/jansson/</a>.</li><li>Asterisk now depends on <code>libuuid</code> and, optionally, <code>uriparser</code>. It is recommended that you install <code>uriparser</code>, even if it is optional.</li><li>The new SIP stack and channel driver currently use a particular version of PJSIP. Please see <a href="https://wiki.asterisk.org/wiki/x/J4GLAQ" rel="nofollow">https://wiki.asterisk.org/wiki/x/J4GLAQ</a> for more information on configuring and installing PJSIP for usage with Asterisk.</li></ul><h1 id="Newin12-Applications"><span style="line-height: 1.25;">Applications</span></h1><h2 id="Newin12-AgentLogin"><a href="Asterisk-12-Application_AgentLogin_26476795.html">AgentLogin</a></h2><ul><li><span style="line-height: 1.5;">Along with <a href="Asterisk-12-Application_AgentRequest_26476796.html">AgentRequest</a>, this application has been modified to be a </span>replacement for <code>chan_agent</code>. The act of a channel calling the AgentLogin application places the channel into a pool of agents that can be requested by the AgentRequest application. Note that this application, as well as all other agent related functionality, is now provided by the <code>app_agent_pool</code> module. See <a href="New-in-12_26476750.html">chan_agent</a> and <a href="New-in-12_26476750.html">AgentRequest</a> for more information.</li><li>This application no longer performs agent authentication. If authentication is desired, the dialplan needs to perform this function using the <a href="Asterisk-12-Application_Authenticate_26476802.html">Authenticate</a> or <a href="Asterisk-12-Application_VMAuthenticate_26476974.html">VMAuthenticate</a> application or through an AGI script before running AgentLogin.</li><li>If this application is called and the agent is already logged in, the dialplan will continue exection with the <code>AGENT_STATUS</code> channel variable set to <code>ALREADY_LOGGED_IN</code>.</li><li>The <em><a href="Asterisk-12-Configuration_app_agent_pool_26477436.html">agents.conf</a></em> schema has changed. Rather than specifying agents on a single line in comma delineated fashion, each agent is defined in a separate context. This allows agents to use the power of context templates in their definition.</li><li>A number of parameters from <em><a href="Asterisk-12-Configuration_app_agent_pool_26477436.html">agents.conf</a></em> have been removed. This includes:<ul><li><code>maxloginretries</code></li><li><code>autologoffunavail</code></li><li><code>updatecdr</code></li><li><code>goodbye</code></li><li><code>group</code></li><li><code>recordformat</code></li><li><code>urlprefix</code></li><li><code>savecallsin</code></li></ul>These options were obsoleted by the move from a channel driver model to the bridging/application model provided by <code>app_agent_pool</code>.</li></ul><p><span class="confluence-anchor-link" id="Newin12-app_AgentRequest"></span></p><h2 id="Newin12-AgentRequest"><a href="Asterisk-12-Application_AgentRequest_26476796.html">AgentRequest</a></h2><ul><li>A new application, this will request a logged in agent from the pool and <span style="line-height: 1.4285715;">bridge the requested channel with the channel calling this application. </span><span style="line-height: 1.4285715;">Logged in agents are those channels that called the <a href="Asterisk-12-Application_AgentLogin_26476795.html">AgentLogin</a> application. </span><span style="line-height: 1.4285715;">If an agent cannot be requested from the pool, the <code>AGENT_STATUS</code> dialplan </span><span style="line-height: 1.4285715;">application will be set with an appropriate error value.</span></li></ul><h2 id="Newin12-AgentMonitorOutgoing">AgentMonitorOutgoing</h2><ul><li>This application has been removed. It was a holdover from when AgentCallbackLogin was removed in Asterisk 1.6.0.</li></ul><h2 id="Newin12-AlarmReceiver"><a href="Asterisk-12-Application_AlarmReceiver_26476800.html">AlarmReceiver</a></h2><ul><li><h2 id="Newin12-AddedsupportforadditionalAdemcoDTMFsignallingformats%2CincludingExpress4%2B1%2CExpress4%2B2%2CHighSpeedandSuperFast."><span style="color: rgb(51,51,51);font-family: &quot;Helvetica Neue&quot; , Helvetica , Arial , sans-serif;font-size: 14.0px;line-height: 1.4285715;">Added support for additional Ademco DTMF signalling formats, including</span> <span style="color: rgb(51,51,51);font-family: &quot;Helvetica Neue&quot; , Helvetica , Arial , sans-serif;font-size: 14.0px;line-height: 1.4285715;">Express 4+1, Express 4+2, High Speed and Super Fast.</span></h2></li><li>Added channel variable <code>ALARMRECEIVER_CALL_LIMIT</code>. This sets the maximum <span style="line-height: 1.4285715;">call time, in milliseconds, to run the application.</span></li><li>Added channel variable <code>ALARMRECEIVER_RETRIES_LIMIT</code>. This sets the <span style="line-height: 1.4285715;">maximum number of times to retry the call.</span></li><li>Added a new configuration option <code>answait</code>. If set, the AlarmReceiver <span style="line-height: 1.4285715;">application will wait the number of milliseconds specified by <code>answait</code> </span><span style="line-height: 1.4285715;">after the channel has answered. Valid values range between 500 </span><span style="line-height: 1.4285715;">milliseconds and 10000 milliseconds.</span></li><li>Added configuration option <code>no_group_meta</code>. If enabled, grouping of metadata <span style="line-height: 1.4285715;">information in the AlarmReceiver log file will be skipped.</span></li></ul><h2 id="Newin12-Answer"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_Answer_26477162.html">Answer</a></span></h2><ul><li><span style="line-height: 1.4285715;">It is now lo longer possible to bypass updating the CDR on the channel when answering. CDRs reflect the state of the channel and will always reflect the time they were Answered.</span></li></ul><h2 id="Newin12-BridgeWait"><a href="Asterisk-12-Application_BridgeWait_26476803.html">BridgeWait</a></h2><ul><li><span style="line-height: 1.4285715;">A new application in Asterisk, this will place the calling channel </span>into a holding bridge, optionally entertaining them with some form of media. Channels participating in a holding bridge do not interact with <span style="line-height: 1.4285715;">other channels in the same holding bridge. Optionally, however, a channel </span><span style="line-height: 1.4285715;">may join as an announcer. Any media passed from an announcer channel is </span><span style="line-height: 1.4285715;">played to all channels in the holding bridge. Channels leave a holding </span><span style="line-height: 1.4285715;">bridge either when an optional timer expires, or via the <a href="Asterisk-12-Application_ChannelRedirect_26476808.html">ChannelRedirect</a> </span><span style="line-height: 1.4285715;">application or <a href="Asterisk-12-ManagerAction_Redirect_26477134.html">AMI Redirect</a> action.</span></li></ul><h2 id="Newin12-ConfBridge"><a href="Asterisk-12-Application_ConfBridge_26476812.html">ConfBridge</a></h2><ul><li><span style="line-height: 1.5;">All participants in a bridge can now be kicked out of a conference room </span>by specifying the channel parameter as 'all' in the ConfBridge kick CLI command, i.e., <code>confbridge kick &lt;conference&gt; all</code></li><li>CLI output for the <code>confbridge list</code> command has been improved. When displaying information about a particular bridge, flags will now be shown for the participating users indicating properties of that user.</li><li>The ConfbridgeList event now contains the following fields: <code>WaitMarked</code>, <code>EndMarked</code>, and <code>Waiting</code>. This displays additional properties about the user's profile, as well as whether or not the user is waiting for a Marked user to enter the conference.</li><li>Added a new option for conference recording, <code><a href="Asterisk-12-Configuration_app_confbridge_26478080.html">record_file_append</a></code>. If enabled, when the recording is stopped and then re-started, the existing recording will be used and appended to.<br />ConfBridge now has the ability to set the language of announcements to the conference. The language can be set on a bridge profile in <a href="Asterisk-12-Configuration_app_confbridge_26478080.html">confbridge.conf</a> or by the dialplan function <a href="Asterisk-12-Function_CONFBRIDGE_26476813.html">CONFBRIDGE(bridge, language)={langauge}</a>.</li></ul><h2 id="Newin12-ControlPlayback"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_ControlPlayback_26476825.html">ControlPlayback</a></span></h2><ul><li>The channel variable <code>CPLAYBACKSTATUS</code> may now return the value <code>REMOTESTOPPED</code>. This occurs when playback is stopped by a remote interface, such as AMI. See the AMI action <a href="New-in-12_26476750.html">ControlPlayback</a> for more information.</li></ul><h2 id="Newin12-Directory"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_Directory_26476836.html">Directory</a></span></h2><ul><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">Added the <code>a</code> option, which allows the caller to enter in an additional </span><span style="line-height: 1.4285715;">alias for the user in the directory. This option must be used in conjunction </span><span style="line-height: 1.4285715;">with the <code>f</code>, <code>l</code>, or <code>b</code> options. Note that the alias for a user can be </span><span style="line-height: 1.4285715;">specified in <em>voicemail.conf</em>.</span></li></ul><h2 id="Newin12-DumpChan"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_DumpChan_26476838.html">DumpChan</a></span></h2><ul><li><span style="line-height: 1.4285715;">The output of DumpChan no longer includes the <code>DirectBridge</code> or <code>IndirectBridge</code> </span><span style="line-height: 1.4285715;">fields. Instead, if a channel is in a bridge, it includes a <code>BridgeID</code> field </span><span style="line-height: 1.4285715;">containing the unique ID of the bridge that the channel happens to be in.</span></li></ul><h2 id="Newin12-ForkCDR"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_ForkCDR_26476849.html">ForkCDR</a></span></h2><ul><li>ForkCDR no longer automatically resets the forked CDR. See the <code>r</code> option for more information.</li><li><span style="line-height: 1.4285715;">Variables are no longer purged from the original CDR. See the <code>v</code> option for </span><span style="line-height: 1.4285715;">more information.</span></li><li>The <code>A</code> option has been removed. The Answer time on a CDR is never updated once set.</li><li>The <code>d</code> option has been removed. The disposition on a CDR is a function of the state of the channel and cannot be altered.</li><li>The <code>D</code> option has been removed. Who the Party B is on a CDR is a function of the state of the respective channels involved in the CDR and cannot be altered.</li><li>The <code>r</code> option has been changed. Previously, ForkCDR always reset the CDR such that the start time and, if applicable, the answer time was updated. Now, by default, ForkCDR simply forks the CDR, maintaining any times. The <code>r</code> option now triggers the Reset, setting the start time (and answer time if applicable) to the current time. Note that the <code>a</code> option still sets the answer time to the current time if the channel was already answered.</li><li>The <code>s</code> option has been removed. A variable can be set on the original CDR if desired using the CDR function, and removed from a forked CDR using the same function.</li><li>The <code>T</code> option has been removed. The concept of <code>DONT_TOUCH</code> and <code>LOCKED</code> no longer applies in the CDR engine.</li><li>The <code>v</code> option now prevents the copy of the variables from the original CDR to the forked CDR. Previously the variables were always copied but were removed from the original. This was changed as removing variables from a CDR can have unintended side effects - this option allows the user to prevent propagation of variables from the original to the forked without modifying the original.</li></ul><h2 id="Newin12-MeetMe"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_MeetMe_26476859.html">MeetMe</a></span></h2><ul><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">Added the </span>n<span style="line-height: 1.4285715;"> option to MeetMe to prevent application of the <a href="Asterisk-12-Function_DENOISE_26477070.html">DENOISE</a> </span><span style="line-height: 1.4285715;">function to a channel joining a conference. Some channel drivers that vary </span><span style="line-height: 1.4285715;">the number of audio samples in a voice frame will experience significant </span><span style="line-height: 1.4285715;">quality problems if a denoiser is attached to the channel; this option gives </span><span style="line-height: 1.4285715;">them the ability to remove the denoiser without having to unload <code>func_speex</code>.</span></li></ul><h2 id="Newin12-MixMonitor"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_MixMonitor_26476879.html">MixMonitor</a></span></h2><ul><li><span style="line-height: 1.4285715;">The <code>b</code> option now includes conferences as well as sounds played to the </span><span style="line-height: 1.4285715;">participants.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-Function_AUDIOHOOK_INHERIT_26476992.html">AUDIOHOOK_INHERIT</a> function is no longer needed to keep a MixMonitor </span><span style="line-height: 1.4285715;">running during a transfer. If a MixMonitor is started on a channel, </span><span style="line-height: 1.4285715;">the MixMonitor will continue to record the audio passing through the </span><span style="line-height: 1.4285715;">channel even in the presence of transfers.</span></li></ul><h2 id="Newin12-NoCDR"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_NoCDR_26476804.html">NoCDR</a></span></h2><ul><li><span style="line-height: 1.4285715;">The NoCDR application is deprecated. Please use the <a href="Asterisk-12-Function_CDR_PROP_26477002.html">CDR_PROP</a> function to </span><span style="line-height: 1.4285715;">disable CDRs.</span></li><li><span style="line-height: 1.4285715;">While the NoCDR application will prevent CDRs for a channel from being propagated to registered CDR backends, it will not prevent that data from being collected. Hence, a subsequent call to <a href="Asterisk-12-Application_ResetCDR_26476805.html">ResetCDR</a> or the <a href="Asterisk-12-Function_CDR_PROP_26477002.html">CDR_PROP</a> function that enables CDRs on a channel will restore those records that have not yet been finalized.</span></li></ul><h2 id="Newin12-ParkAndAnnounce"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_ParkAndAnnounce_26478089.html">ParkAndAnnounce</a></span></h2><ul><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">The <code>app_parkandannounce</code> module has been removed. The application </span><span style="line-height: 1.4285715;">ParkAndAnnounce is now provided by the <code>res_parking</code> module. See the </span><span style="line-height: 1.4285715;"><a href="New-in-12_26476750.html">res_parking</a> changes for more information.</span></li></ul><h2 id="Newin12-Queue"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_Queue_26476897.html">Queue</a></span></h2><ul><li><p><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">Added queue available hint. The hint can be added to the dialplan using the </span><span style="line-height: 1.4285715;">following syntax:<br /></span></p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>exten =&gt; {exten},hint,Queue:{queue_name}_avail</pre>
</div></div><p><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">For example, if the name of the queue is <code>markq</code> and the extension is <code>8501</code>:<br /></span></p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>exten =&gt; 8501,hint,Queue:markq_avail</pre>
</div></div><p><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">This will report <code>In Use</code> if there are no logged in agents or no free agents. </span><span style="line-height: 1.4285715;">It will report <code>Idle</code> when an agent is free.</span></p></li><li><p>Queues now support a hint for member paused state. The hint uses the following syntax:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>exten =&gt; {exten},hint,Queue:{queue_name}_pause_{member_name}</pre>
</div></div><p>Where <code>queue_name</code> and <code>member_name</code> are the name of the queue and the name of the member to subscribe to, respectively. For example, for the sales queue, with queue member mark at extension 8501:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>exten =&gt; 8501,hint,Queue:sales_pause_mark</pre>
</div></div><p><span style="line-height: 1.4285715;">Members will show as <code>In Use</code> when paused.</span></p></li><li>The configuration options <code>eventwhencalled</code> and <code>eventmemberstatus</code> have been removed. As a result, the AMI events <a href="Asterisk-12-ManagerEvent_QueueMemberStatus_26477356.html">QueueMemberStatus</a>, <a href="Asterisk-12-ManagerEvent_AgentCalled_26477325.html">AgentCalled</a>, <a href="Asterisk-12-ManagerEvent_AgentConnect_26477355.html">AgentConnect</a>, <a href="Asterisk-12-ManagerEvent_AgentComplete_26477368.html">AgentComplete</a>, <a href="Asterisk-12-ManagerEvent_AgentDump_26477362.html">AgentDump</a>, and <a href="Asterisk-12-ManagerEvent_AgentRingNoAnswer_26477314.html">AgentRingNoAnswer</a> will always be sent. The <em>Variable</em> fields will also no longer exist on the <code>Agent*</code> events. These events can be filtered out from a connected AMI client using the <code>eventfilter</code> setting in <em>manager.conf</em>.</li><li>The queue log now differentiates between blind and attended transfers. A blind transfer will result in a <code>BLINDTRANSFER</code> message with the destination context and extension. An attended transfer will result in an <code>ATTENDEDTRANSFER</code> message. This message will indicate the method by which the attended transfer was completed: <code>BRIDGE</code> for a bridge merge, <code>APP</code> for running an application on a bridge or channel, or <code>LINK</code> for linking two bridges together with local channels. The queue log will also now detect externally initiated blind and attended transfers and record the transfer status accordingly.</li><li>When performing queue pause/unpause on an interface without specifying an individual queue, the <code>PAUSEALL</code>/{{UNPAUSEALL}} event will only be logged if at least one member of any queue exists for that interface.</li><li>Added the <code>queue_log_realtime_use_gmt</code> option to have timestamps in GMT for realtime queue log entries.</li></ul><h2 id="Newin12-ResetCDR"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_ResetCDR_26476805.html">ResetCDR</a></span></h2><ul><li><span style="line-height: 1.4285715;">The <code>e</code> option has been deprecated. Use the <a href="Asterisk-12-Function_CDR_PROP_26477002.html">CDR_PROP</a> function to re-enable </span><span style="line-height: 1.4285715;">CDRs when they were previously disabled on a channel.</span></li><li>The <code>w</code> and <code>a</code> options have been removed. Dispatching CDRs to registered backends occurs on an as-needed basis in order to preserve linkedid propagation and other needed behavior.</li></ul><h2 id="Newin12-SayAlphaCase"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_SayAlphaCase_26477179.html">SayAlphaCase</a></span></h2><ul><li><p><span style="line-height: 1.4285715;">A new application, this is similar to <a href="Asterisk-12-Application_SayAlpha_26477178.html">SayAlpha</a> except that it supports </span><span style="line-height: 1.4285715;">case sensitive playback of the specified characters. For example:<br /></span></p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>same =&gt; n,SayAlphaCase(u,aBc)</pre>
</div></div><p><span style="line-height: 1.4285715;">Will result in 'a uppercase b c'.</span></p></li></ul><h2 id="Newin12-SetAMAFlags"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_SetAMAFlags_26477185.html">SetAMAFlags</a></span></h2><ul><li><span style="line-height: 1.4285715;">This application is deprecated in favor of <a href="Asterisk-12-Function_CHANNEL_26477005.html">CHANNEL(amaflags)</a>.</span></li></ul><h2 id="Newin12-SendDTMF"><span style="line-height: 1.4285715;"> </span><a href="Asterisk-12-Application_SendDTMF_26476930.html"><span style="line-height: 1.4285715;">S</span><span style="line-height: 1.4285715;">endDTMF</span></a><span style="line-height: 1.4285715;"> </span></h2><ul><li><span style="line-height: 1.4285715;">The SendDTMF application will now accept <code>W</code> as valid input. This will cause </span><span style="line-height: 1.4285715;">the application to delay one second while streaming DTMF.</span></li></ul><h2 id="Newin12-Stasis"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_Stasis_26476960.html">Stasis</a></span></h2><ul><li><span style="line-height: 1.4285715;">A new application in Asterisk 12, this hands control of the channel calling </span><span style="line-height: 1.4285715;">the application over to an external system. Currently, external systems </span><span style="line-height: 1.4285715;">manipulate channels in Stasis through the <a href="Asterisk-12-ARI_22773909.html">Asterisk REST Interface (ARI)</a>.</span></li></ul><h2 id="Newin12-UserEvent"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_UserEvent_26476968.html">UserEvent</a></span></h2><ul><li><span style="line-height: 1.4285715;">UserEvent will now handle duplicate keys by overwriting the previous value </span><span style="line-height: 1.4285715;">assigned to the key.</span></li><li><span style="line-height: 1.4285715;">In addition to AMI, UserEvent invocations will now be distributed to any </span><span style="line-height: 1.4285715;">interested <a href="Asterisk-12-Application_Stasis_26476960.html">Stasis</a> applications.</span></li></ul><h2 id="Newin12-VoiceMail"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Application_VoiceMail_26476971.html">VoiceMail</a></span></h2><ul><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">The<em> voicemail.conf</em> configuration file now has an <code>alias</code> configuration </span><span style="line-height: 1.4285715;">parameter for use with the <a href="Asterisk-12-Application_Directory_26476836.html">Directory</a> application. The voicemail realtime </span><span style="line-height: 1.4285715;">database table schema has also been updated with an <code>alias</code> column.</span></li><li><span style="line-height: 1.4285715;">Mailboxes defined in <code>voicemail.conf</code> <strong>MUST</strong> be referenced by their full name by entities that want to subscribe for MWI, i.e., <code>mailbox@context</code>. Previously, Asterisk would automatically append &quot;@default&quot; to a mailbox name if it wasn't specified; however, in order to support other providers of voicemail, this is no longer possible. <br /></span></li></ul><p><span style="line-height: 1.4285715;color: rgb(133,120,102);font-family: MuseoSans700 , sans-serif;font-size: 24.0px;">Codecs</span></p><ul><li>Pass through support has been added for both VP8 and Opus.</li><li>Added format attribute negotiation for the Opus codec. Format attribute <span style="line-height: 1.4285715;">negotiation is provided by the <code>res_format_attr_opus</code> module.</span></li></ul><h1 id="Newin12-Core"><span style="line-height: 1.4285715;">Core</span></h1><ul><li>Masquerades as an operation inside Asterisk have been effectively hidden by the migration to the Bridging API. As such, many 'quirks' of Asterisk no longer occur. This includes renaming of channels, &quot;&lt;ZOMBIE&gt;&quot; channels, dropping of frame/audio hooks, and other internal implementation details that users had to deal with. This fundamental change has large implications throughout the changes documented for this version.</li><li><span style="line-height: 1.4285715;">Multiple parties in a bridge may now be transferred. If a participant in a multi-party bridge initiates a blind transfer, a Local channel will be used to execute the dialplan location that the transferer sent the parties to. If a participant in a multi-party bridge initiates an attended transfer, several options are possible. If the attended transfer results in a transfer to an application, a Local channel is used. If the attended transfer results in a transfer to another channel, the resulting channels will be merged into a single bridge.</span></li><li><span style="line-height: 1.4285715;">The channel variable <code>ATTENDED_TRANSFER_COMPLETE_SOUND</code> is no longer channel driver specific. If the channel variable is set on the transferrer channel, the sound will be played to the target of an attended transfer.</span></li><li><span style="line-height: 1.4285715;">The channel variable <code>BRIDGEPEER</code> becomes a comma separated list of peers in </span><span style="line-height: 1.4285715;">a multi-party bridge. The <code>BRIDGEPEER</code> value can have a maximum of 10 peers </span><span style="line-height: 1.4285715;">listed. Any more peers in the bridge will not be included in the list. {{</span><span style="line-height: 1.4285715;">BRIDGEPEER}} is not valid in holding bridges like parking since those channels </span><span style="line-height: 1.4285715;">do not talk to each other even though they are in a bridge.</span></li><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">The channel variable <code>BRIDGEPVTCALLID</code> is only valid for two party bridges </span><span style="line-height: 1.4285715;">and will contain a value if the <code>BRIDGEPEER</code>'s channel driver supports it.</span></li><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">A channel variable <code>ATTENDEDTRANSFER</code> is now set which indicates which channel </span><span style="line-height: 1.4285715;">was responsible for an attended transfer in a similar fashion to <code>BLINDTRANSFER</code>.</span></li><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">Modules using the Configuration Framework or Sorcery must have XML </span><span style="line-height: 1.4285715;">configuration documentation. This configuration documentation is included </span><span style="line-height: 1.4285715;">with the rest of Asterisk's XML documentation, and is accessible via CLI </span><span style="line-height: 1.4285715;">commands. See the<a href="New-in-12_26476750.html"> CLI changes</a> for more information.</span></li></ul><h2 id="Newin12-AMI%28AsteriskManagerInterface%29"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">AMI (Asterisk Manager Interface)</span></h2><ul><li><span style="line-height: 1.4285715;">Major changes were made to both the syntax as well as the semantics of the </span><span style="line-height: 1.4285715;">AMI protocol. In particular, AMI events have been substantially improved </span><span style="line-height: 1.4285715;">in this version of Asterisk. For more information, please see the </span><a href="AMI-v2-Specification_22086004.html"><span style="line-height: 1.4285715;">AMI </span><span style="line-height: 1.4285715;">specification</span></a><span style="line-height: 1.4285715;">.</span></li><li><a href="https://wiki.asterisk.org/wiki/x/dAFRAQ" style="line-height: 1.4285715;" rel="nofollow"><span style="line-height: 1.4285715;">AMI events that reference a particular channel or bridge will now always contain a standard set of fields. When multiple channels or bridges are referenced in an event, fields for at least some subset of the channels and bridges in the event will be prefixed with a descriptive name to avoid name collisions. See the </span></a><a href="Asterisk-12-AMI-Events_26476694.html">AMI event </a>documentation for more information.</li><li><span style="line-height: 1.4285715;">The CLI command <code>manager show commands</code> no longer truncates command names longer than 15 characters and no longer shows authorization requirement for commands. <code>manager show command</code> now displays the privileges needed for using a given manager command instead.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-ManagerAction_SIPshowpeer_26476781.html">SIPshowpeer</a> action will now include a <em>SubscribeContext</em> field for a peer in its response if the peer has a subscribe context set.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-ManagerAction_SIPqualifypeer_26476782.html">SIPqualifypeer</a> action now acknowledges the request once it has established that the request is against a known peer. It also issues a new event, <a href="Asterisk-12-ManagerEvent_SIPQualifyPeerDone_26477320.html">SIPQualifyPeerDone</a>, once the qualify action has been completed.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-ManagerAction_PlayDTMF_26476931.html">PlayDTMF</a> action now supports an optional <em>Duration</em> parameter. This specifies the duration of the digit to be played, in milliseconds.</span></li><li><span style="line-height: 1.4285715;">Added <a href="Asterisk-12-ManagerAction_VoicemailRefresh_26476980.html">VoicemailRefresh</a> action to allow an external entity to trigger mailbox </span><span style="line-height: 1.4285715;">updates when changes occur instead of requiring the use of <code>pollmailboxes</code>.</span></li></ul><p><span class="confluence-anchor-link" id="Newin12-ami_controlplayback"></span></p><ul><li>Added a new action <a href="Asterisk-12-ManagerAction_ControlPlayback_26476826.html">ControlPlayback</a>. The ControlPlayback action allows an AMI client to manipulate audio currently being played back on a channel. The supported operations depend on the application being used to send audio to the channel. When the audio playback was initiated using the <a href="Asterisk-12-Application_ControlPlayback_26476825.html">ControlPlayback</a> application or <a href="Asterisk-12-AGICommand_control-stream-file_26477194.html">CONTROL STREAM FILE</a> AGI command, the audio can be paused, stopped, restarted, reversed, or skipped forward. When initiated by other mechanisms (such as the <a href="Asterisk-12-Application_Playback_26476893.html">Playback</a> application), the audio can be stopped, reversed, or skipped forward.</li><li><span style="line-height: 1.4285715;">Channel related events now contain a snapshot of channel state, adding new </span><span style="line-height: 1.4285715;">fields to many of these events.</span></li><li><span style="line-height: 1.4285715;">The AMI event <a href="Asterisk-12-ManagerEvent_NewExten_26477317.html">Newexten</a> field <em>Extension</em> is deprecated, and may be removed </span><span style="line-height: 1.4285715;">in a future release. Please use the common <em>Exten</em> field instead.</span></li><li><span style="line-height: 1.4285715;">The AMI event <a href="Asterisk-12-ManagerEvent_UserEvent_26477318.html">UserEvent</a> from <code>app_userevent</code> now contains the channel state </span><span style="line-height: 1.4285715;">fields. The channel state fields will come before the body fields.</span></li><li><span style="line-height: 1.4285715;">The AMI events <a href="Asterisk-12-ManagerEvent_ParkedCall_26478103.html">ParkedCall</a>, <a href="Asterisk-12-ManagerEvent_ParkedCallTimeOut_26478092.html">ParkedCallTimeOut</a>, <a href="Asterisk-12-ManagerEvent_ParkedCallGiveUp_26478101.html">ParkedCallGiveUp</a>, and </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-ManagerEvent_UnParkedCall_26478099.html">UnParkedCall</a> have changed significantly in the new <a href="New-in-12_26476750.html"><code>res_parking</code> </a> module.</span><ul><li><span style="line-height: 1.4285715;">The <em>Channel</em> and <em>From</em> headers are gone.</span><ul><li><span style="line-height: 1.4285715;">For the channel that was parked </span><span style="line-height: 1.4285715;">or is coming out of parking, a <em>Parkee</em> channel snapshot is issued and it </span><span style="line-height: 1.4285715;">has a number of fields associated with it. The old <em>Channel</em> header relayed </span><span style="line-height: 1.4285715;">the same data as the new <em>ParkeeChannel</em> header.</span></li><li><span style="line-height: 1.4285715;">The <em>From</em> field was ambiguous and changed meaning depending on the event. </span><span style="line-height: 1.4285715;">For most of these, it was the name of the channel that parked the call </span><span style="line-height: 1.4285715;">(the <em>Parker</em>).</span></li></ul></li><li><span style="line-height: 1.4285715;">There is no longer a header that provides this channel name, </span><span style="line-height: 1.4285715;">however the <em>ParkerDialString</em> will contain a dialstring to redial the </span><span style="line-height: 1.4285715;">device that parked the call.</span></li><li><span style="line-height: 1.4285715;">On <a href="Asterisk-12-ManagerEvent_UnParkedCall_26478099.html">UnParkedCall</a> events, the <em>From</em> header would instead represent the channel responsible for retrieving the parkee. It receives a channel snapshot labeled <em>Retriever</em>. The <em>From</em> field is is replaced with <em>RetrieverChannel</em>.</span></li><li><span style="line-height: 1.4285715;">Lastly, the <em>Exten</em> field has been replaced with <em>ParkingSpace</em>.</span></li></ul></li><li>The AMI event Parkinglot (response to <a href="Asterisk-12-ManagerAction_Parkinglots_26478084.html">Parkinglots</a> command) in a similar fashion has changed the field names <em>StartExten</em> and <em>StopExten</em> to <em>StartSpace</em> and <em>StopSpace</em> respectively.</li><li><span style="line-height: 1.4285715;">The deprecated use of | (pipe) as a separator in the <code>channelvars</code> setting in <em>manager.conf</em> has been removed.</span></li><li><span style="line-height: 1.4285715;">Channel Variables conveyed with a channel no longer contain the name of the channel as part of the key field, i.e., <code>ChanVariable(SIP/foo): bar=baz</code> is now <code>ChanVariable: bar=baz</code>. When multiple channels are present in a single AMI event, the various <em>ChanVariable</em> fields will contain a prefix that specifies which channel they correspond to.</span></li><li><span style="line-height: 1.4285715;">The NewPeerAccount AMI event is no longer raised. The <a href="Asterisk-12-ManagerEvent_NewAccountCode_26477336.html">NewAccountCode</a> AMI event always conveys the AMI event for a particular channel.</span></li><li>All <a href="Asterisk-12-ManagerEvent_Reload_26477376.html">Reload</a> events have been consolidated into a single event type. This event will always contain a <em>Module</em> field specifying the name of the module and a <em>Status</em> field denoting the result of the reload. All modules now issue this event when being reloaded.</li><li>The ModuleLoadReport event has been removed. Most AMI connections would fail to receive this event due to being connected after modules have loaded. AMI connections that want to know when Asterisk is ready should listen for the <a href="Asterisk-12-ManagerEvent_FullyBooted_26477364.html">FullyBooted</a> event.</li><li><code>app_fax</code> now sends the same send fax/receive fax events as <code>res_fax</code>. The FaxSent event is now the <a href="Asterisk-12-ManagerEvent_SendFAX_26477309.html">SendFAX</a> event, and the FaxReceived event is now the <a href="Asterisk-12-ManagerEvent_ReceiveFAX_26477324.html">ReceiveFAX</a> event.</li><li><span style="line-height: 1.4285715;">The MusicOnHold event is now two events: <a href="Asterisk-12-ManagerEvent_MusicOnHoldStart_26477341.html">MusicOnHoldStart</a> and </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-ManagerEvent_MusicOnHoldStop_26477381.html">MusicOnHoldStop</a>. The sub type field has been removed.</span></li><li>The JabberEvent event has been removed. It is not AMI's purpose to be a carrier for another protocol.</li><li>The <a href="Asterisk-12-ManagerAction_Bridge_26477115.html">Bridge</a> Manager action's <em>Playtone</em> header now accepts more fine-grained options. <code>Channel1</code> and <code>Channel2</code> may be specified in order to play a tone to the specific channel. <code>Both</code> may be specified to play a tone to both</li><li>channels. The old <code>yes</code> option is still accepted as a way of playing the tone to <code>Channel2</code> only.</li><li>The AMI <a href="Asterisk-12-ManagerEvent_Status_26477357.html">Status</a> response event to the AMI <a href="Asterisk-12-ManagerAction_Status_26477126.html">Status</a> action replaces the <em>BridgedChannel</em> and <em>BridgedUniqueid</em> headers with the <em>BridgeID</em> header to indicate what bridge the channel is currently in.</li><li>The AMI Hold event has been moved out of individual channel drivers, into core, and is now two events: <a href="Asterisk-12-ManagerEvent_Hold_26477330.html">Hold</a> and <a href="Asterisk-12-ManagerEvent_Unhold_26477380.html">Unhold</a>. The status field has been removed.</li><li>The AMI events in <code>app_queue</code> have been made more consistent with each other. Events that reference channels (QueueCaller* and Agent*) will show information about each channel. The (infamous) Join and Leave AMI events have been changed to <a href="Asterisk-12-ManagerEvent_QueueCallerJoin_26477358.html">QueueCallerJoin</a> and <a href="Asterisk-12-ManagerEvent_QueueCallerLeave_26477337.html">QueueCallerLeave</a>.</li><li>The <a href="Asterisk-12-ManagerEvent_MCID_26477327.html">MCID</a> AMI event now publishes a channel snapshot when available and its non-channel-snapshot parameters now use either the <em>MCallerID</em> or <em>MConnectedID</em> prefixes with Subaddr*, Name*, and Num* suffixes instead of <em>CallerID</em> and <em>ConnectedID</em> to avoid confusion with similarly named parameters in the channel snapshot.</li><li>The AMI events Agentlogin and Agentlogoff have been renamed <a href="Asterisk-12-ManagerEvent_AgentLogin_26477378.html">AgentLogin</a> and <a href="Asterisk-12-ManagerEvent_AgentLogoff_26477372.html">AgentLogoff</a> respectively.</li><li>The <em>Channel</em> key used in the <a href="Asterisk-12-ManagerEvent_AlarmClear_26477385.html">AlarmClear</a>, <a href="Asterisk-12-ManagerEvent_Alarm_26477375.html">Alarm</a>, and <a href="Asterisk-12-ManagerEvent_DNDState_26477374.html">DNDState</a> has been renamed <em>DAHDIChannel</em> since it does not convey an Asterisk channel name.</li><li><span style="line-height: 1.4285715;">ChannelUpdate events have been removed.</span></li><li><span style="line-height: 1.4285715;">All AMI events now contain a <em>SystemName</em> field, if available.</span></li><li>Local channel optimization is now conveyed in two events: <a href="Asterisk-12-ManagerEvent_LocalOptimizationBegin_26477384.html">LocalOptimizationBegin</a> and <a href="Asterisk-12-ManagerEvent_LocalOptimizationEnd_26477306.html">LocalOptimizationEnd</a>. The Begin event is sent when the Local channel driver begins attempting to optimize itself out of the media path; the End event is sent after the channel halves have successfully optimized themselves out of the media path.</li><li><span style="line-height: 1.4285715;">Local channel information in events is now prefixed with <em>LocalOne</em> and <em>LocalTwo.</em></span><span style="line-height: 1.4285715;"> This replaces the suffix of '1' and '2' for the two halves of </span><span style="line-height: 1.4285715;">the Local channel. This affects the <a href="Asterisk-12-ManagerEvent_LocalBridge_26477301.html">LocalBridge</a>, <a href="Asterisk-12-ManagerEvent_LocalOptimizationBegin_26477384.html">LocalOptimizationBegin</a>, </span><span style="line-height: 1.4285715;">and <a href="Asterisk-12-ManagerEvent_LocalOptimizationEnd_26477306.html">LocalOptimizationEnd</a> events.</span></li><li>The option <code>allowmultiplelogin</code> can now be set or overriden in a particular account. When set in the general context, it will act as the default setting for defined accounts.</li><li>The BridgeAction event was removed. It technically added no value, as the <a href="Asterisk-12-ManagerAction_Bridge_26477115.html">Bridge</a> Action already receives confirmation of the bridge through a successful completion Event.</li><li><span style="line-height: 1.4285715;">The BridgeExec events were removed. These events duplicated the events that </span><span style="line-height: 1.4285715;">occur in the Bridging API, and are conveyed now through <a href="Asterisk-12-ManagerEvent_BridgeCreate_26477367.html">BridgeCreate</a>, </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-ManagerEvent_BridgeEnter_26477312.html">BridgeEnter</a>, and <a href="Asterisk-12-ManagerEvent_BridgeLeave_26477359.html">BridgeLeave</a> events.</span></li><li>The <a href="Asterisk-12-ManagerEvent_RTCPSent_26477377.html">RTCPSent</a>/<a href="Asterisk-12-ManagerEvent_RTCPReceived_26477363.html">RTCPReceived</a> events have been significantly modified from previous versions. They now report all SR/RR packets sent/received, and have been restructured to better reflect the data sent in a SR/RR. In particular, the event structure now supports multiple report blocks.</li><li><span style="line-height: 1.4285715;">Added <a href="Asterisk-12-ManagerEvent_BlindTransfer_26477345.html">BlindTransfer</a> and <a href="Asterisk-12-ManagerEvent_AttendedTransfer_26477350.html">AttendedTransfer</a> events. These events are </span><span style="line-height: 1.4285715;">raised when a blind transfer/attended transfer completes successfully. </span><span style="line-height: 1.4285715;">They contain information about the transfer that just completed, including </span><span style="line-height: 1.4285715;">the location of the transferred channel.</span></li><li><span style="line-height: 1.4285715;">Added a 'security' class authorization for security events emitted by AMI. Note that these events are produced by the Asterisk Security Event framework.<br /></span></li></ul><h2 id="Newin12-CDR%28CallDetailRecords%29">CDR (Call Detail Records)</h2><ul><li>Significant changes have been made to the behavior of CDRs. The CDR engine was effectively rewritten and built on the Stasis message bus. For a full definition of CDR behavior in Asterisk 12, please read the <a href="Asterisk-12-CDR-Specification_22088359.html">CDR specification for Asterisk 12</a>.</li><li>CDRs will now be created between all participants in a bridge. For each pair of channels in a bridge, a CDR is created to represent the path of communication between those two endpoints. This lets an end user choose who to bill for what during bridge operations with multiple parties.</li><li>The <code>duration</code>, <code>billsec</code>, <code>start</code>, <code>answer</code>, and <code>end</code> times now reflect the times associated with the current CDR for the channel, as opposed to a cumulative measurement of all CDRs for that channel.</li><li>When a CDR is dispatched, user defined CDR variables from both parties are included in the resulting CDR. If both parties have the same variable, only the Party A value is provided.</li><li>Added a new option to <em><a href="Asterisk-12-Configuration_cdr_26477747.html">cdr.conf</a></em>, <code>debug</code>. When enabled, significantly more information regarding the CDR engine is logged as verbose messages. This option should only be used if the behavior of the CDR engine needs to be debugged.</li><li>Added CLI command <code>cdr set debug {on|off</code>}. This toggles the <code>debug</code> setting normally configured in <em>cdr.conf</em>.</li><li>Added CLI command <code>cdr show active {channel</code>}. When <code>{channel</code>} is not specified, this command provides a summary of the channels with CDR information and their statistics. When <code>{channel</code>} is specified, it shows detailed information about all records associated with <code>{channel</code>}.</li></ul><h2 id="Newin12-CEL%28ChannelEventLogging%29">CEL (Channel Event Logging)</h2><ul><li><span style="line-height: 1.4285715;">CEL has undergone significant rework in Asterisk 12, and is now built on the </span>Stasis message bus. Please see the<a href="Asterisk-12-CEL-Specification_25919712.html"> specification for CEL </a>for more detailed information.</li><li>The <em>extra</em> field of all CEL events that use it now consists of a JSON blob <span style="line-height: 1.4285715;">with key/value pairs which are defined in the Asterisk 12 CEL documentation. This JSON blob will be interpreted by the various CEL backends into their specific format.</span></li><li><span style="line-height: 1.4285715;"><code>BLINDTRANSFER</code> events now report the transferee bridge unique </span><span style="line-height: 1.4285715;">identifier, extension, and context in a JSON blob as the extra string </span><span style="line-height: 1.4285715;">instead of the transferee channel name as the peer.</span></li><li><span style="line-height: 1.4285715;"><code>ATTENDEDTRANSFER</code> events now report the peer as NULL and additional </span><span style="line-height: 1.4285715;">information in the 'extra' string as a JSON blob. For transfers that occur </span><span style="line-height: 1.4285715;">between two bridged channels, the 'extra' JSON blob contains the primary </span><span style="line-height: 1.4285715;">bridge unique identifier, the secondary channel name, and the secondary </span><span style="line-height: 1.4285715;">bridge unique identifier. For transfers that occur between a bridged channel </span><span style="line-height: 1.4285715;">and a channel running an app, the 'extra' JSON blob contains the primary </span><span style="line-height: 1.4285715;">bridge unique identifier, the secondary channel name, and the app name.</span></li><li><span style="line-height: 1.4285715;"><code>LOCAL_OPTIMIZE</code> events have been added to convey local channel </span><span style="line-height: 1.4285715;">optimizations with the record occurring for the semi-one channel and </span><span style="line-height: 1.4285715;">the semi-two channel name in the peer field.</span></li><li><span style="line-height: 1.4285715;"><code>BRIDGE_START</code>, <code>BRIDGE_END</code>, <code>BRIDGE_UPDATE</code>, <code>3WAY_START</code>, <code>3WAY_END</code>, <code>CONF_ENTER</code>, <code>CONF_EXIT</code></span><span style="line-height: 1.4285715;">, <code>CONF_START</code>, and <code>CONF_END</code> events have all been removed. These </span><span style="line-height: 1.4285715;">events have been replaced by <code>BRIDGE_ENTER</code>/ <code>BRIDGE_EXIT</code>. The <code>BRIDGE_ENTER</code> </span><span style="line-height: 1.4285715;">and <code>BRIDGE_EXIT</code> events are raised when a channel enters/exits any bridge, </span><span style="line-height: 1.4285715;">regardless of whether or not that bridge happens to contain multiple </span><span style="line-height: 1.4285715;">parties.</span></li></ul><p><span class="confluence-anchor-link" id="Newin12-CLI"></span></p><h2 id="Newin12-CLI">CLI</h2><ul><li><span style="line-height: 1.4285715;">When compiled with <code>--enable-dev-mode</code>, the <code>astobj2</code> library will now add </span><span style="line-height: 1.4285715;">several CLI commands that allow for inspection of <code>ao2</code> containers that </span><span style="line-height: 1.4285715;">register themselves with <code>astobj2</code>. The CLI commands are:</span><ul><li><span style="line-height: 1.4285715;"><code>astobj2 container dump</code><br /></span></li><li><span style="line-height: 1.4285715;"><code>astobj2 container stats</code></span></li><li><span style="line-height: 1.4285715;"><code>astobj2 container check</code><br /></span></li></ul></li><li><span style="line-height: 1.4285715;">Added specific CLI commands for bridge inspection. This includes:</span><ul><li><span style="line-height: 1.4285715;"><code>bridge show all</code> - list all bridges in the system</span></li><li><span style="line-height: 1.4285715;"><code>bridge show {id</code>} - </span><span style="line-height: 1.4285715;">provide specific information about a bridge</span></li></ul></li><li><span style="line-height: 1.4285715;">Added CLI command <code>bridge destroy</code>. This will destroy the specified bridge, </span><span style="line-height: 1.4285715;">ejecting the channels currently in the bridge. If the channels cannot </span><span style="line-height: 1.4285715;">continue in the dialplan or application that put them in the bridge, they </span><span style="line-height: 1.4285715;">will be hung up.</span></li><li><span style="line-height: 1.4285715;">Added command <code>bridge kick</code>. This will eject a single channel from a bridge.</span></li><li><span style="line-height: 1.4285715;">Added commands to inspect and manipulate the registered bridge technologies. T</span><span style="line-height: 1.4285715;">his includes:</span><ul><li><span style="line-height: 1.4285715;"><code>bridge technology show</code> - list the registered bridge </span><span style="line-height: 1.4285715;">technologies</span></li><li><span style="line-height: 1.4285715;"><code>bridge technology {suspend|unsuspend} {tech}</code> - </span><span style="line-height: 1.4285715;">control whether or not a registered bridge technology can be used </span><span style="line-height: 1.4285715;">during smart bridge operations. If a technology is suspended, it will not </span><span style="line-height: 1.4285715;">be used when a bridge technology is picked for channels; when unsuspended, </span><span style="line-height: 1.4285715;">it can be used again.</span></li></ul></li><li><span style="line-height: 1.4285715;">The command <code>config show help</code> will show c</span><span style="line-height: 1.4285715;">onfiguration documentation for modules with XML configuration </span><span style="line-height: 1.4285715;">documentation. This takes in three optional parameters - <code>module</code>, <code>type</code>, and <code>option - </code>which, when provided, provider greater detail.</span><ul><li><span style="line-height: 1.4285715;">When <code>module</code>, <code>type</code>, and <code>option</code> are omitted, a listing </span><span style="line-height: 1.4285715;">of all modules with registered documentation is displayed.</span></li><li><span style="line-height: 1.4285715;">When <code>module</code> </span><span style="line-height: 1.4285715;">is specified, a listing of all configuration types for that module is </span><span style="line-height: 1.4285715;">displayed, along with their synopsis.</span></li><li><span style="line-height: 1.4285715;">When <code>module</code> and <code>type</code> are </span><span style="line-height: 1.4285715;">specified, a listing of all configuration options for that type are </span><span style="line-height: 1.4285715;">displayed along with their synopsis.</span></li><li><span style="line-height: 1.4285715;">When <code>module</code>, <code>type</code>, and <code>option</code> </span><span style="line-height: 1.4285715;">are specified, detailed information for that configuration option is </span><span style="line-height: 1.4285715;">displayed.</span></li></ul></li><li><span style="line-height: 1.4285715;">Added <code>core show sounds</code> and <code>core show sound</code> CLI commands. These display </span><span style="line-height: 1.4285715;">a listing of all installed media sounds available on the system and </span><span style="line-height: 1.4285715;">detailed information about a sound, respectively.</span></li><li><span style="line-height: 1.4285715;"><code>xmldoc dump</code> has been added. This CLI command will dump the XML </span><span style="line-height: 1.4285715;">documentation DOM as a string to the specified file. The Asterisk core </span><span style="line-height: 1.4285715;">will populate certain XML elements pulled from the source files with </span><span style="line-height: 1.4285715;">additional run-time information; this command lets a user produce the </span><span style="line-height: 1.4285715;">XML documentation with all information.</span></li></ul><p><span style="line-height: 1.4285715;color: rgb(133,120,102);font-family: MuseoSans500 , sans-serif;font-size: 20.0px;">Features</span></p><ul><li><span style="line-height: 1.4285715;">Parking has been pulled from core and placed into a separate module called </span><span style="line-height: 1.4285715;"><a href="New-in-12_26476750.html">res_parking</a>. Configuration for </span><span style="line-height: 1.4285715;">parking should now be performed in <a href="Asterisk-12-Configuration_res_parking_26477923.html"><em>res_parking.conf</em></a>. Configuration for </span><span style="line-height: 1.4285715;">parking in <a href="Asterisk-12-Configuration_features_26477757.html"><em>features.conf</em> </a> is now unsupported.</span></li><li><span style="line-height: 1.4285715;">Core attended transfers now have several new options. While performing an </span><span style="line-height: 1.4285715;">attended transfer, the transferer now has the following options:</span><ul><li><span style="line-height: 1.4285715;"><code>*1</code> - cancel the attended transfer (configurable via <code>atxferabort</code>)</span></li><li><span style="line-height: 1.4285715;"><code>*2</code> - complete the attended transfer, dropping out of the call </span><span style="line-height: 1.4285715;">(configurable via <code>atxfercomplete</code>)</span></li><li><span style="line-height: 1.4285715;"><code>*3</code> - complete the attended transfer, but stay in the call. This will turn </span><span style="line-height: 1.4285715;">the call into a multi-party bridge (configurable via <code>atxferthreeway</code>)</span></li><li><span style="line-height: 1.4285715;"><code>*4</code> - swap to the other party. Once an attended transfer has begun, this </span><span style="line-height: 1.4285715;">options may be used multiple times (configurable via <code>atxferswap</code>)</span></li></ul></li><li><span style="line-height: 1.4285715;">For DTMF blind and attended transfers, the channel variable <code>TRANSFER_CONTEXT</code> </span><span style="line-height: 1.4285715;">must be on the channel initiating the transfer to have any effect.</span></li><li><span style="line-height: 1.4285715;">The <code>BRIDGE_FEATURES</code> channel variable would previously only set features for </span><span style="line-height: 1.4285715;">the calling party and would set this feature regardless of whether the </span><span style="line-height: 1.4285715;">feature was in caps or in lowercase. Use of a caps feature for a letter </span><span style="line-height: 1.4285715;">will now apply the feature to the calling party while use of a lowercase </span><span style="line-height: 1.4285715;">letter will apply that feature to the called party.</span></li><li><span style="line-height: 1.4285715;">Add support for <code>automixmon</code> to the <code>BRIDGE_FEATURES</code> channel variable.</span></li><li><span style="line-height: 1.4285715;">The channel variable <code>DYNAMIC_PEERNAME</code> is redundant with <code>BRIDGEPEER</code> and is </span><span style="line-height: 1.4285715;">removed. The more useful <code>DYNAMIC_WHO_ACTIVATED</code> gives the channel name that </span><span style="line-height: 1.4285715;">activated the dynamic feature.</span></li><li><span style="line-height: 1.4285715;">The channel variables <code>DYNAMIC_FEATURENAME</code> and <code>DYNAMIC_WHO_ACTIVATED</code> are set </span><span style="line-height: 1.4285715;">only on the channel executing the dynamic feature. Executing a dynamic </span><span style="line-height: 1.4285715;">feature on the bridge peer in a multi-party bridge will execute it on all </span><span style="line-height: 1.4285715;">peers of the activating channel.</span></li><li><span style="line-height: 1.4285715;">You can now have the settings for a channel updated using the <a href="Asterisk-12-Function_FEATURE_26477116.html">FEATURE()</a> </span><span style="line-height: 1.4285715;">and <a href="Asterisk-12-Function_FEATUREMAP_26477117.html">FEATUREMAP() </a>functions inherited to child channels by setting <code>FEATURE(inherit)=yes</code>.</span></li><li><span style="line-height: 1.4285715;"><code>automixmon</code> now supports additional channel variables from <code>automon</code> including: <code>TOUCH_MIXMONITOR_PREFIX</code>, <code>TOUCH_MIXMONITOR_MESSAGE_START</code>, and <code>TOUCH_MIXMONITOR_MESSAGE_STOP</code>.</span></li><li><span style="line-height: 1.4285715;">A new general <a href="Asterisk-12-Configuration_features_26477757.html"><em>features.conf</em> </a> option <code>recordingfailsound</code> has been added which </span><span style="line-height: 1.4285715;">allows setting a failure sound for a user tries to invoke a recording feature </span><span style="line-height: 1.4285715;">such as <code>automon</code> or <code>automixmon</code> and it fails.</span></li><li><span style="line-height: 1.4285715;">It is no longer necessary (or possible) to define the <code>ATXFER_NULL_TECH</code> in <code>features.c</code> </span><span style="line-height: 1.4285715;">for <code>atxferdropcall=no</code> to work properly. This option now just </span><span style="line-height: 1.4285715;">works.</span></li></ul><h2 id="Newin12-Logging"><span style="line-height: 1.4285715;">Logging</span></h2><ul><li><span style="line-height: 1.4285715;">Added log rotation strategy <code>none</code>. If set, no log rotation strategy will </span>be used. Given that this can cause the Asterisk log files to grow quickly, this option should only be used if an external mechanism for log management is preferred.</li></ul><h2 id="Newin12-RealtimeRealtime"><span class="confluence-anchor-link" id="Newin12-Realtime"></span>Realtime</h2><ul><li>Dynamic realtime tables for SIP Users can now include a <code>path</code> field. This <span style="line-height: 1.4285715;">will store the path information for that peer when it registers. Realtime </span><span style="line-height: 1.4285715;">tables can also use the <code>supportpath</code> field to enable Path header support.</span></li><li><span style="line-height: 1.4285715;">LDAP realtime configurations for SIP Users now have the <code>AstAccountPathSupport</code> <code>objectIdentifier</code></span><span style="line-height: 1.4285715;">. This maps to the <code>supportpath</code> option in <em>sip.conf</em>.</span></li></ul><h2 id="Newin12-Sorcery"><span style="line-height: 1.4285715;">Sorcery</span></h2><ul><li><span style="line-height: 1.4285715;">Sorcery is a new data abstraction and object persistence API in Asterisk. It </span><span style="line-height: 1.4285715;">provides modules a useful abstraction on top of the many storage mechanisms </span><span style="line-height: 1.4285715;">in Asterisk, including the Asterisk Database, static configuration files, </span><span style="line-height: 1.4285715;">static Realtime, and dynamic Realtime. It also provides a caching service. </span><span style="line-height: 1.4285715;">Users can configure a hierarchy of data storage layers for specific modules </span><span style="line-height: 1.4285715;">in <em>sorcery.conf</em>.</span></li><li>All future modules which utilize Sorcery for object persistence must have a <span style="line-height: 1.4285715;">column named <code>id</code> within their schema when using the Sorcery realtime module. </span><span style="line-height: 1.4285715;">This column must be able to contain a string of up to 128 characters in length.</span></li></ul><h2 id="Newin12-SecurityEventsFramework"><span style="line-height: 1.4285715;">Security Events Framework</span></h2><ul><li>Security Event timestamps now use ISO 8601 formatted date/time instead of <span style="line-height: 1.4285715;">the <code>seconds-microseconds</code> format that it was using previously.</span></li></ul><h2 id="Newin12-StasisMessageBus"><span style="line-height: 1.4285715;">Stasis Message Bus</span></h2><ul><li>The Stasis message bus is a publish/subscribe message bus internal to <span style="line-height: 1.4285715;">Asterisk. Many services in Asterisk are built on the Stasis message bus, </span><span style="line-height: 1.4285715;">including AMI, ARI, CDRs, and CEL. Parameters controlling the operation of </span><span style="line-height: 1.4285715;">Stasis can be configured in <em>stasis.conf</em>. Note that these parameters operate </span><span style="line-height: 1.4285715;">at a very low level in Asterisk, and generally will not require changes.</span></li></ul><h1 id="Newin12-ChannelDrivers"><br />Channel Drivers<span style="line-height: 1.25;"> </span></h1><ul><li><span style="line-height: 1.25;">When a channel driver is configured to enable jiterbuffers, they are now </span><span style="line-height: 1.4285715;">applied unconditionally when a channel joins a bridge. If a jitterbuffer </span><span style="line-height: 1.4285715;">is already set for that channel when it enters, such as by the <a href="Asterisk-12-Function_JITTERBUFFER_26477041.html">JITTERBUFFER</a> </span><span style="line-height: 1.4285715;">function, then the existing jitterbuffer will be used and the one set by </span><span style="line-height: 1.4285715;">the channel driver will not be applied.</span></li></ul><p><span class="confluence-anchor-link" id="Newin12-channels_chan_agent"></span></p><h2 id="Newin12-chan_agent">chan_agent</h2><ul><li><code>chan_agent</code> has been removed and replaced with <a href="Asterisk-12-Application_AgentLogin_26476795.html">AgentLogin</a> and <a href="Asterisk-12-Application_AgentRequest_26476796.html">AgentRequest</a> <span style="line-height: 1.4285715;">dialplan applications provided by the <code>app_agent_pool</code> module. Agents are </span><span style="line-height: 1.4285715;">connected with callers using the new <a href="Asterisk-12-Application_AgentRequest_26476796.html">AgentRequest</a> dialplan application. </span><span style="line-height: 1.4285715;">The <code>Agents:&lt;agent-id&gt;</code> device state is available to monitor the status of an </span><span style="line-height: 1.4285715;">agent. See <a href="Asterisk-12-Configuration_app_agent_pool_26477436.html"><em>agents.conf.sample</em> </a> for valid configuration options.</span></li><li><span style="line-height: 1.4285715;">The <code>updatecdr</code> option has been removed. Altering the names of channels on a </span><span style="line-height: 1.4285715;">CDR is not supported - the name of the channel is the name of the channel, </span><span style="line-height: 1.4285715;">and pretending otherwise helps no one. The <code>AGENTUPDATECDR</code> channel variable </span><span style="line-height: 1.4285715;">has also been removed, for the same reason.</span></li><li><span style="line-height: 1.4285715;">The <code>endcall</code> and <code>enddtmf</code> configuration options are removed. Use the </span><span style="line-height: 1.4285715;">dialplan function <code><a href="Asterisk-12-Function_CHANNEL_26477005.html">CHANNEL(dtmf-features)</a></code> to set DTMF features on the agent </span><span style="line-height: 1.4285715;">channel before calling AgentLogin.</span></li></ul><h2 id="Newin12-chan_bridge">chan_bridge</h2><ul><li><code>chan_bridge</code> has been removed. Its functionality has been incorporated <span style="line-height: 1.4285715;">directly into the <a href="Asterisk-12-Application_ConfBridge_26476812.html">ConfBridge</a> application itself.</span></li></ul><h2 id="Newin12-chan_dahdi">chan_dahdi</h2><ul><li><span style="line-height: 1.5;">Added the CLI command <code>pri destroy span</code>. This will destroy the D-channel </span><span style="line-height: 1.4285715;">of the specified span and its B-channels. Note that this command should </span><span style="line-height: 1.4285715;">only be used if you understand the risks it entails.</span></li><li><span style="line-height: 1.4285715;">The CLI command <code>dahdi destroy channel</code> is now <code>dahdi destroy channels</code>. </span><span style="line-height: 1.4285715;">A range of channels can be specified to be destroyed. Note that this command </span><span style="line-height: 1.4285715;">should only be used if you understand the risks it entails.</span></li><li><span style="line-height: 1.4285715;">Added the CLI command <code>dahdi create channels</code>. A range of channels can be </span><span style="line-height: 1.4285715;">specified to be created, or the keyword <code>new</code> can be used to add channels </span><span style="line-height: 1.4285715;">not yet created.</span></li><li><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span>The script specified by the <code>chan_dahdi.conf</code> <code>mwimonitornotify</code> option now gets the exact configured mailbox name.  For <code>app_voicemail</code> mailboxes this is<span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span> <code>mailbox@context</code>.<span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span></li><li>Added <code>mwi_vm_boxes</code> that also must be configured for ISDN MWI to be enabled.<span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span></li></ul><h2 id="Newin12-chan_iax2"><span style="line-height: 1.4285715;">chan_iax2</span></h2><ul><li><span style="line-height: 1.4285715;"> </span>IPv6 support has been added. chan_iax2 is now able to bind to and<span style="line-height: 1.4285715;"> </span> communicate using IPv6 addresses.</li></ul><h2 id="Newin12-chan_local"><span style="line-height: 1.4285715;">chan_local</span></h2><ul><li><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">The <code>/b</code> option has been removed.</span></li><li><code>chan_local</code> moved into the system core and is no longer a loadable module.</li></ul><h2 id="Newin12-chan_mobile">chan_mobile</h2><ul><li>Added general support for busy detection.</li><li>Added ECAM command support for Sony Ericsson phones.</li></ul><h2 id="Newin12-chan_pjsip"><span style="line-height: 1.4285715;">chan_pjsip</span></h2><ul><li><span style="line-height: 1.4285715;">A new SIP channel driver for Asterisk, chan_pjsip is built on the PJSIP </span><span style="line-height: 1.4285715;">SIP stack. A collection of resource modules provides the bulk of the SIP </span><span style="line-height: 1.4285715;">functionality. For more information on configuring the new SIP channel driver, see the <a href="Configuring-res_pjsip_25919621.html">Configuring res_pjsip</a>.</span></li></ul><h2 id="Newin12-chan_sip">chan_sip</h2><ul><li>Added support for <a href="http://tools.ietf.org/html/rfc3327" class="external-link" rel="nofollow">RFC 3327 &quot;Path&quot;</a> headers. This can be enabled in <em>sip.conf</em> using the <code>supportpath</code> setting, either on a global basis or on a peer basis. This setting enables Asterisk to route outgoing out-of-dialog requests via a set of proxies by using a pre-loaded route-set defined by the Path headers in the <code>REGISTER</code> request. See <a href="New-in-12_26476750.html">Realtime</a> updates for more configuration information.</li><li><p><span style="line-height: 1.4285715;">The <code>SIP_CODEC</code> family of variables may now specify more than one codec. Each </span><span style="line-height: 1.4285715;">codec must be separated by a comma. The first codec specified is the </span><span style="line-height: 1.4285715;">preferred codec for the offer. This allows a dialplan writer to specify both </span><span style="line-height: 1.4285715;">audio and video codecs, e.g., </span></p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>same =&gt; n,Set(SIP_CODEC=ulaw,h264)</pre>
</div></div></li><li><span style="line-height: 1.4285715;">The <code>callevents</code> parameter has been removed. <a href="Asterisk-12-ManagerEvent_Hold_26477330.html">Hold</a> AMI events are now raised </span><span style="line-height: 1.4285715;">in the core, and can be filtered out using the <code>eventfilter</code> parameter </span><span style="line-height: 1.4285715;">in <em>manager.conf</em>.</span></li><li><span style="line-height: 1.4285715;">Added <code>ignore_requested_pref</code>. When enabled, this will use the preferred </span><span style="line-height: 1.4285715;">codecs configured for a peer instead of the requested codec.</span></li><li><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span>The option <code>register_retry_403</code> has been added to chan_sip to work around<span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span> servers that are known to erroneously send 403 in response to valid<span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span> REGISTER requests and allows Asterisk to continue attepmting to connect.<span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span><span style="line-height: 1.4285715;"><span style="line-height: 1.4285715;"> </span></span></li></ul><h2 id="Newin12-chan_skinny"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">chan_skinny</span></h2><ul><li><span style="line-height: 1.4285715;">Added the <code>immeddialkey</code> parameter. If set, when the user presses the </span><span style="line-height: 1.4285715;">configured key the already entered number will be immediately dialed. This </span><span style="line-height: 1.4285715;">is useful when the dialplan allows for variable length pattern matching. </span>Valid options are <code>*</code> and <code>#</code>.</li><li>Added the <code>callfwdtimeout</code> parameter. This configures the amount of time (in <span style="line-height: 1.4285715;">milliseconds) before a call forward is considered to not be answered.</span></li><li><span style="line-height: 1.4285715;">The <code>serviceurl</code> parameter allows Service URLs to be attached to line </span><span style="line-height: 1.4285715;">buttons.</span></li></ul><h1 id="Newin12-Functions">Functions</h1><h2 id="Newin12-AGENT"><a href="Asterisk-12-Function_AGENT_26476797.html">AGENT</a></h2><ul><li><span style="line-height: 1.4285715;">The password option has been disabled, as the <a href="Asterisk-12-Application_AgentLogin_26476795.html">AgentLogin</a> application no </span><span style="line-height: 1.4285715;">longer provides authentication.</span></li></ul><h2 id="Newin12-AUDIOHOOK_INHERIT"><a href="Asterisk-12-Function_AUDIOHOOK_INHERIT_26476992.html">AUDIOHOOK_INHERIT</a></h2><ul><li>Due to changes in the Asterisk core, this function is no longer needed to preserve a <a href="Asterisk-12-Application_MixMonitor_26476879.html">MixMonitor</a> on a channel during transfer operations and dialplan execution. It is effectively obsolete.</li></ul><h2 id="Newin12-CDR%28function%29"><a href="Asterisk-12-Function_CDR_26477001.html">CDR (function)</a></h2><ul><li>The <code>amaflags</code> and <code>accountcode</code> attributes for the <a href="Asterisk-12-Function_CDR_26477001.html">CDR</a> function are deprecated. Use the <a href="Asterisk-12-Function_CHANNEL_26477005.html">CHANNEL</a> function instead to access these attributes.</li><li><span style="line-height: 1.4285715;">The <code>l</code> option has been removed. When reading a CDR attribute, the most </span><span style="line-height: 1.4285715;">recent record is always used. When writing a CDR attribute, all non-finalized </span><span style="line-height: 1.4285715;">CDRs are updated.</span></li><li>The <code>r</code> option has been removed, for the same reason as the <code>l</code> option.</li><li><span style="line-height: 1.4285715;">The <code>s</code> option has been removed, as <code>LOCKED</code> semantics no longer exist in the </span><span style="line-height: 1.4285715;">CDR engine.</span></li></ul><h2 id="Newin12-CDR_PROP"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_CDR_PROP_26477002.html">CDR_PROP</a></span></h2><ul><li><span style="line-height: 1.4285715;">A new function <a href="Asterisk-12-Function_CDR_PROP_26477002.html">CDR_PROP</a> has been added. This function lets you set properties </span><span style="line-height: 1.4285715;">on a channel's active CDRs. This function is write-only. Properties accept </span><span style="line-height: 1.4285715;">boolean values to set/clear them on the channel's CDRs. Valid properties </span><span style="line-height: 1.4285715;">include:</span><ul><li><span style="line-height: 1.4285715;"> <code>party_a</code></span><span style="line-height: 1.4285715;"> - make this channel the preferred Party A in any CDR between two </span><span style="line-height: 1.4285715;">channels. If two channels have this property set, the creation time of the </span><span style="line-height: 1.4285715;">channel is used to determine who is Party A. Note that dialed channels are </span><span style="line-height: 1.4285715;">ever Party A in a CDR.</span></li><li><span style="line-height: 1.4285715;"><code>disable</code> - disable CDRs on this channel. This is analogous to the <a href="Asterisk-12-Application_NoCDR_26476804.html">NoCDR</a> </span><span style="line-height: 1.4285715;">application when set to <code>True</code>, and analogous to the <code>e</code> option in <a href="Asterisk-12-Application_ResetCDR_26476805.html">ResetCDR</a> </span><span style="line-height: 1.4285715;">when set to <code>False</code>.</span></li></ul></li></ul><h2 id="Newin12-CHANNEL"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_CHANNEL_26477005.html">CHANNEL</a></span></h2><ul><li><span style="line-height: 1.4285715;">Added the argument <code>dtmf_features</code>. This sets the DTMF features that will be </span><span style="line-height: 1.4285715;">enabled on a channel when it enters a bridge. Allowed values are <code>T</code>, <code>K</code>, <code>H</code></span><span style="line-height: 1.4285715;">, <code>W</code>, and <code>X</code>, and are analogous to the parameters passed to the <a href="Asterisk-12-Application_Dial_26476831.html">Dial</a> </span><span style="line-height: 1.4285715;">application.</span></li><li><span style="line-height: 1.4285715;">Added the argument <code>after_bridge_goto</code>. This can be set to a parseable Goto </span><span style="line-height: 1.4285715;">string, i.e., <code>[[context],extension],priority</code>. When set, if a </span><span style="line-height: 1.4285715;">channel leaves a bridge but is not hung up it will resume dialplan execution </span><span style="line-height: 1.4285715;">at that location.</span></li></ul><h2 id="Newin12-JITTERBUFFER"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_JITTERBUFFER_26477041.html">JITTERBUFFER</a></span></h2><ul><li><span style="line-height: 1.4285715;">JITTERBUFFER now accepts an argument of <code>disabled</code> which can be used </span><span style="line-height: 1.4285715;">to remove jitterbuffers previously set on a channel with JITTERBUFFER. </span><span style="line-height: 1.4285715;">The value of this setting is ignored when disabled is used for the argument.</span></li></ul><h2 id="Newin12-PJSIP_DIAL_CONTACTS"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_PJSIP_DIAL_CONTACTS_26476770.html">PJSIP_DIAL_CONTACTS</a></span></h2><ul><li><span style="line-height: 1.4285715;">A new function provided by <code>chan_pjsip</code>, this function can be used in </span><span style="line-height: 1.4285715;">conjunction with the <a href="Asterisk-12-Application_Dial_26476831.html">Dial</a> application to construct a dial string that will </span><span style="line-height: 1.4285715;">dial all contacts on an Address of Record associated with a <code>chan_pjsip</code> </span><span style="line-height: 1.4285715;">endpoint.</span></li></ul><h2 id="Newin12-PJSIP_MEDIA_OFFER"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_PJSIP_MEDIA_OFFER_26476771.html">PJSIP_MEDIA_OFFER</a></span></h2><ul><li><span style="line-height: 1.4285715;">Provided by <code>chan_pjsip</code>, this function sets the codecs to be offered on the </span><span style="line-height: 1.4285715;">outbound channel prior to dialing.</span></li></ul><h2 id="Newin12-REDIRECTING"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_REDIRECTING_26477000.html">REDIRECTING</a></span></h2><ul><li><span style="line-height: 1.4285715;">Redirecting reasons can now be set to arbitrary strings. This means </span><span style="line-height: 1.4285715;">that the REDIRECTING dialplan function can be used to set the redirecting </span><span style="line-height: 1.4285715;">reason to any string. It also allows for custom strings to be read as the </span><span style="line-height: 1.4285715;">redirecting reason from SIP Diversion headers.</span></li></ul><h2 id="Newin12-SPEECH_ENGINE"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_SPEECH_ENGINE_26476949.html">SPEECH_ENGINE</a></span></h2><ul><li><span style="line-height: 1.4285715;">The SPEECH_ENGINE function now supports read operations. When read from, it </span><span style="line-height: 1.4285715;">will return the current value of the requested attribute.</span></li></ul><h2 id="Newin12-VMCOUNT"><span style="line-height: 1.4285715;"><a href="Asterisk-12-Function_VMCOUNT_26477104.html">VMCOUNT</a></span></h2><ul><li>Mailboxes defined by <code>app_voicemail</code> <strong>MUST</strong> be referenced by the rest of the system as <code>mailbox@context</code>.  The rest of the system cannot add <code>@default</code> to mailbox identifiers for <code>app_voicemail</code> that do not specify a context any longer.  It is a mailbox identifier format that should only be interpreted by <code>app_voicemail</code>.</li></ul><h1 id="Newin12-Resources"><span style="line-height: 1.4285715;">Resources</span></h1><h2 id="Newin12-res_agi%28AsteriskGatewayInterface%29"><span style="line-height: 1.4285715;">res_agi (Asterisk Gateway Interface)</span></h2><ul><li><span style="line-height: 1.4285715;">The manager event AGIExec has been split into <a href="Asterisk-12-ManagerEvent_AGIExecStart_26477326.html">AGIExecStart</a> and <a href="Asterisk-12-ManagerEvent_AGIExecEnd_26477323.html">AGIExecEnd</a>.</span></li><li><span style="line-height: 1.4285715;">The manager event AsyncAGI has been split into <a href="Asterisk-12-ManagerEvent_AsyncAGIStart_26477322.html">AsyncAGIStart</a>, <a href="Asterisk-12-ManagerEvent_AsyncAGIExec_26477328.html">AsyncAGIExec</a>, </span><span style="line-height: 1.4285715;">and <a href="Asterisk-12-ManagerEvent_AsyncAGIEnd_26477340.html">AsyncAGIEnd</a>.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-AGICommand_control-stream-file_26477194.html">CONTROL STREAM FILE</a> command now accepts an <code>offsetms</code> parameter. This </span><span style="line-height: 1.4285715;">will start the playback of the audio at the position specified. It will </span><span style="line-height: 1.4285715;">also return the final position of the file in <code>endpos</code>.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-AGICommand_control-stream-file_26477194.html">CONTROL STREAM FILE</a> command will now populate the <code>CPLAYBACKSTATUS</code> </span><span style="line-height: 1.4285715;">channel variable if the user stopped the file playback or if a remote </span><span style="line-height: 1.4285715;">entity stopped the playback. If neither stopped the playback, it will </span><span style="line-height: 1.4285715;">indicate the overall success/failure of the playback. If stopped early, </span><span style="line-height: 1.4285715;">the final offset of the file will be set in the <code>CPLAYBACKOFFSET</code> channel </span><span style="line-height: 1.4285715;">variable.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-AGICommand_say-alpha_26477209.html">SAY ALPHA</a> command now accepts an additional parameter to control </span><span style="line-height: 1.4285715;">whether it specifies the case of uppercase, lowercase, or all letters to </span><span style="line-height: 1.4285715;">provide functionality similar to <a href="Asterisk-12-Application_SayAlphaCase_26477179.html">SayAlphaCase</a>.</span></li></ul><h2 id="Newin12-res_ari%28AsteriskRESTInterface%29%28andothers%29"><span style="line-height: 1.4285715;">res_ari (Asterisk REST Interface) (and others)</span></h2><ul><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-ARI_22773909.html">Asterisk REST Interface (ARI)</a> provides a mechanism to expose and </span><span style="line-height: 1.4285715;">control telephony primitives in Asterisk by remote client. This includes </span><span style="line-height: 1.4285715;">channels, bridges, endpoints, media, and other fundamental concepts. Users </span><span style="line-height: 1.4285715;">of ARI can develop their own communications applications, controlling </span><span style="line-height: 1.4285715;">multiple channels using an HTTP REST interface and receiving JSON events </span><span style="line-height: 1.4285715;">about the objects via a WebSocket connection. ARI can be configured in </span><span style="line-height: 1.4285715;">Asterisk via <a href="Asterisk-12-Configuration_ari_26477886.html"><em>ari.conf</em> </a>.</span></li></ul><h2 id="Newin12-res_parkingres_parking"><span class="confluence-anchor-link" id="Newin12-res_parking"></span><span style="line-height: 1.4285715;">res_parking</span></h2><ul><li><span style="line-height: 1.4285715;">Parking has been extracted from the Asterisk core as a loadable module, <code>res_parking</code>.</span><span style="line-height: 1.4285715;"> Configuration for parking is now provided by <a href="Asterisk-12-Configuration_res_parking_26477923.html"><em>res_parking.conf</em>.</a> </span><span style="line-height: 1.4285715;">Configuration through <em>features.conf</em> is no longer supported.</span></li></ul>    <div class="aui-message warning shadowed information-macro">
                            <span class="aui-icon icon-warning">Icon</span>
                <div class="message-content">
                            <p><span><code>res_parking</code> uses the configuration framework. If an invalid configuration is </span><span>supplied, <code>res_parking</code> will fail to load or fail to reload. Previously, </span><span>invalid configurations would generally be accepted, with certain errors </span><span>resulting in individually disabled parking lots.</span></p>
                    </div>
    </div>
<ul><li><span style="line-height: 1.4285715;">Parked calls are now placed in bridges. While this is largely an architectural change, it does have implications on how channels in a parking lot are viewed. For example, commands that display channels in bridges will now also display the channels in a parking lot.</span></li><li><span style="line-height: 1.4285715;">The order of arguments for the new parking applications have been modified. Timeout and return <code>context/exten/priority</code> are now implemented as options, while the name of the parking lot is now the first parameter. See the application documentation for <a href="Asterisk-12-Application_Park_26478087.html">Park</a>, <a href="Asterisk-12-Application_ParkedCall_26478088.html">ParkedCall</a>, and <a href="Asterisk-12-Application_ParkAndAnnounce_26478089.html">ParkAndAnnounce</a> for more in-depth information as well as syntax.</span></li><li><span style="line-height: 1.4285715;">Extensions are by default no longer automatically created in the dialplan to park calls or pickup parked calls. Generation of dialplan extensions can be enabled using the <code>parkext</code> configuration option.</span></li><li><span style="line-height: 1.4285715;">ADSI functionality for parking is no longer supported. The <code>adsipark</code> configuration option has been removed as a result.</span></li><li><span style="line-height: 1.4285715;">The <code>PARKINGSLOT</code> channel variable has been deprecated in favor of <code>PARKING_SPACE</code> to match the naming scheme of the new system.</span></li><li><span style="line-height: 1.4285715;"><code>PARKING_SPACE</code> and <code>PARKEDLOT</code> channel variables will now be set for a parked channel even when the configuration option <code>comebactoorigin</code> is enabled.</span></li><li><span style="line-height: 1.4285715;">A new CLI command <code>parking show</code> has been added. This allows a user to inspect the parking lots that are currently in use. <code>parking show &lt;parkinglot&gt;</code> will also show the parked calls in a specific parking lot.</span></li><li><span style="line-height: 1.4285715;">The CLI command <code>parkedcalls</code> is now deprecated in favor of <code>parking show &lt;parkinglot&gt;</code>.</span></li><li><span style="line-height: 1.4285715;">The AMI command <a href="Asterisk-12-ManagerAction_ParkedCalls_26478085.html">ParkedCalls</a> will now accept a <em>ParkingLot</em> argument which can be used to get a list of parked calls for a specific parking lot.</span></li><li><span style="line-height: 1.4285715;">The AMI command <a href="Asterisk-12-ManagerAction_Park_26478086.html">Park</a> field <em>Channel2</em> has been deprecated and replaced with <em>TimeoutChannel</em>. If both <em>Channel2</em> and <em>TimeoutChannel</em> are specified, <em>TimeoutChannel</em> will be used. The field <em>TimeoutChannel</em> is no longer a required argument.</span></li><li><span style="line-height: 1.4285715;">The <a href="Asterisk-12-Application_ParkAndAnnounce_26478089.html">ParkAndAnnounce</a> application is now provided through <code>res_parking</code> instead of through the separate <code>app_parkandannounce</code> module.</span></li></ul><ul><li><a href="Asterisk-12-Application_ParkAndAnnounce_26478089.html">ParkAndAnnounce</a> will no longer go to the next position in dialplan on timeout by default. Instead, it will follow the timeout rules of the parking lot. The old behavior can be reproduced by using the <code>c</code> option.</li><li>Dynamic parking lots will now fail to be created under the following conditions:<ul><li><span style="line-height: 1.4285715;">If the parking lot specified by <code>PARKINGDYNAMIC</code> does not exist.</span></li><li><span style="line-height: 1.4285715;">If they require exclusive park and parked call extensions which overlap with existing parking lots.</span></li></ul></li><li>Dynamic parking lots will be cleared on reload for dynamic parking lots that currently contain no calls. Dynamic parking lots containing parked calls will persist through the reloads without alteration.</li><li>If <code>parkext_exclusive</code> is set for a parking lot and that extension is already in use when that parking lot tries to register it, this is now considered a parking system configuration error. Configurations which do this will be rejected.</li><li>Added channel variable <code>PARKER_FLAT</code>. This contains the name of the extension that would be used if <code>comebacktoorigin</code> is enabled. This can be useful when <code>comebacktoorigin</code> is disabled, but the dialplan or an external control mechanism wants to use the extension in the park-dial context that was generated to re-dial the parker on timeout.</li></ul><h2 id="Newin12-res_pjsip%28andmanyothers%29"><span style="line-height: 1.4285715;">res_pjsip (and many others)</span></h2><ul><li><span style="line-height: 1.4285715;">A large number of resource modules make up the SIP stack based on PJSIP. </span><span style="line-height: 1.4285715;">The <code>chan_pjsip</code> channel driver users these resource modules to provide </span><span style="line-height: 1.4285715;">various SIP functionality in Asterisk. The majority of configuration for </span><span style="line-height: 1.4285715;">these modules is performed in <a href="Asterisk-12-Configuration_res_pjsip_26477927.html"><em>pjsip.conf</em> </a>. Other modules may use their </span><span style="line-height: 1.4285715;">own configuration files. See <a href="Asterisk-12-Module-Configuration_26476700.html">Asterisk 12 Module Configuration</a> for more information.</span></li></ul><h2 id="Newin12-res_rtp_asterisk"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">res_rtp_asterisk</span></h2><ul><li><span style="line-height: 1.4285715;">ICE/STUN/TURN support in <code>res_rtp_asterisk</code> has been made optional. To enable </span><span style="line-height: 1.4285715;">them, the Asterisk-specific version of PJSIP should now be installed. </span><span style="line-height: 1.4285715;">Tarballs are available from </span><a href="https://github.com/asterisk/pjproject/tags/" style="line-height: 1.4285715;" class="external-link" rel="nofollow">https://github.com/asterisk/pjproject/tags/</a><span style="line-height: 1.4285715;">.</span></li></ul><h2 id="Newin12-res_statsd%2Fres_chan_stats"><span style="line-height: 1.4285715;">res_statsd/res_chan_stats</span></h2><ul><li><span style="line-height: 1.4285715;">A new resource module, <code>res_statsd</code>, has been added, which acts as a <a href="https://github.com/etsy/statsd/" class="external-link" rel="nofollow">statsd</a> </span><span style="line-height: 1.4285715;">client. This module allows Asterisk to publish statistics to a statsd </span><span style="line-height: 1.4285715;">server. In conjunction with <code>res_chan_stats</code>, it will publish statistics about Asterisk </span><span style="line-height: 1.4285715;">channels to the statsd server. It can be configured via <a href="Asterisk-12-Configuration_res_statsd_26477935.html"><em>res_statsd.conf</em></a>.</span></li></ul><h2 id="Newin12-res_xmpp"><span style="line-height: 1.4285715;">res_xmpp</span></h2><ul><li><p><span style="line-height: 1.4285715;">Device state for XMPP buddies is now available using the following format:<br /></span></p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>XMPP/&lt;client name&gt;/&lt;buddy address&gt;</pre>
</div></div><p><span style="line-height: 1.4285715;">If any resource is available the device state is considered to be not in use. </span><span style="line-height: 1.4285715;">If no resources exist or all are unavailable the device state is considered </span><span style="line-height: 1.4285715;">to be unavailable.</span></p></li></ul><h1 id="Newin12-Scripts"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">Scripts</span></h1><h2 id="Newin12-Realtime%2FDatabaseScripts"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">Realtime/Database Scripts</span></h2><ul><li><span style="line-height: 1.4285715;">Asterisk previously included example db schemas in the <code>contrib/realtime/</code> </span><span style="line-height: 1.4285715;">directory of the source tree. This has been replaced by a set of database </span><span style="line-height: 1.4285715;">migrations using the <a href="https://alembic.readthedocs.org/en/latest/tutorial.html" class="external-link" rel="nofollow">Alembic framework</a>. This allows you to use Alembic to </span><span style="line-height: 1.4285715;">initialize the database for you. It will also serve as a database migration </span><span style="line-height: 1.4285715;">tool when upgrading Asterisk in the future. </span><span style="line-height: 1.4285715;">See <a href="http://svn.asterisk.org/svn/asterisk/branches/12/contrib/ast-db-manage/README.md" class="external-link" rel="nofollow">contrib/ast-db-manage/README.md</a> for more details.</span></li></ul><h2 id="Newin12-sip_to_res_pjsip.py"><span style="line-height: 1.4285715;"> </span><span style="line-height: 1.4285715;">sip_to_res_pjsip.py</span></h2><ul><li><span style="line-height: 1.4285715;">A new script has been added in the <code>contrib/scripts/sip_to_res_pjsip</code> folder. </span><span style="line-height: 1.4285715;">This python script will convert an existing <em>sip.conf</em> file to a <em>pjsip.conf</em></span><span style="line-height: 1.4285715;"> file, for use with the <code>chan_pjsip</code> channel driver. This script </span><span style="line-height: 1.4285715;">is meant to be an aid in converting an existing <code>chan_sip</code> configuration to </span><span style="line-height: 1.4285715;">a <code>chan_pjsip</code> configuration, but it is expected that configuration beyond </span><span style="line-height: 1.4285715;">what the script provides will be needed.</span></li></ul><p><span style="line-height: 1.4285715;"><br /></span></p>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer">
                <section class="footer-body">
                    <p>Document generated by Confluence on Dec 20, 2013 14:13</p>
                </section>
            </div>
        </div>     </body>
</html>
